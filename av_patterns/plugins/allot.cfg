# Alienvault plugin
# Author: Alienvault Team at avteam@alienvault.com
# Plugin allot id:1608 version: 0.0.3
# Last modification: 2015-05-13 16:11
#
# Plugin Selection Info:
# Allot Communications:NetEnforcer:-
#
# END-HEADER
# Accepted products:
# Allot - NetEnforcer_AC-500 -
# Description:
# You probably should edit these files: \n /etc/default/snmpd, starting snmptrapd this way:\n  TRAPDRUN=yes /etc/snmp/snmptrapd.conf, adding a line like this:\n disableAuthorization yes
# 
#

[DEFAULT]
plugin_id=1608

[config]
type=detector
enable=yes
source=log
location=/var/log/syslog
create_file=false

process=snmptrapd
start=yes
stop=no


startup=/etc/init.d/snmpd start
shutdown=/etc/init.d/snmpd stop

[translation]
2603.0.1=1 ;alDeviceConfChangeTrap
2603.0.2=2 ;alCatalogConfChangeTrap
2603.0.3=3 ;alLineConfChangeTrap
2603.0.4=4 ;alPipeConfChangeTrap
2603.0.5=5 ;alVCConfChangeTrap
2603.0.6=6 ;alAlertRisingTrap
2603.0.7=7 ;alAlertFallingTrap
2603.0.10=8 ;alDataSourceDownTrap
2603.0.11=9 ;alDataSourceUpTrap
2603.0.12=10 ;alSoftwareProblemTrap
2603.0.13=11 ;alAccessViolationTrap
2603.0.14=12 ;alIpAddrConfChangeTrap
2603.0.15=13 ;alConnRouteConfChangeTrap
2603.0.16=14 ;alDeviceStatusUpTrap
2603.0.17=15 ;alDeviceStatusDownTrap
2603.0.18=16 ;alApplicationInfoTrap
2603.0.19=17 ;alBoardStatusChangeTrap
2603.0.20=18 ;alWebUpdateTrap
1.1.5.1=19 ;coldStart
1.1.5.3=20 ;linkDown
1.1.5.4=21 ;linkUp
1.1.5.5=22 ;authenticationFailure
2603.5.5.20.1.1=23 ;SMPProvisionErrTrap
2603.5.5.20.1.2=24 ;SMPMultiFailTrap
2603.5.5.20.1.3=25 ;SmpHighAvailabilityTrap
1123.4.500.2=26 ;storageArrayCritical
2.6.158.4.4.2.1.1=27 ;ibmSpTrapTempC
2.6.158.4.4.2.1.2=28 ;ibmSpTrapVoltC
2.6.158.4.4.2.1.3=29 ;ibmSpTrapTampC
2.6.158.4.4.2.1.4=30 ;ibmSpTrapMffC
2.6.158.4.4.2.1.5=31 ;ibmSpTrapPsC
2.6.158.4.4.2.1.6=32 ;ibmSpTrapHdC
2.6.158.4.4.2.1.7=33 ;ibmSpTrapVrmC
2.6.158.4.4.2.2.2=34 ;ibmSpTrapSffC
2.6.158.4.4.2.1.9=35 ;ibmSpTrapIhcC
2.6.158.4.4.2.2.1=36 ;ibmSpTrapRdpsN
2.6.158.4.4.2.2.3=37 ;ibmSpTrapTempN
2.6.158.4.4.2.2.4=38 ;ibmSpTrapVoltN
2.6.158.4.4.2.2.6=39 ;ibmSpTrapRmN
2.6.158.4.5.2.6=40 ;ibmSpTrapRLogin
2.6.158.4.5.2.8=41 ;ibmSpTrapLogFull
2.6.158.4.5.2.12=42 ;ibmSpTrapLog75
2.6.158.4.5.2.14=43 ;ibmSpTrapSecDvS
2.6.158.4.4.2.3.1=44 ;ibmSpTrapPostToS
2.6.158.4.4.2.3.2=45 ;ibmSpTrapOsToS
2.6.158.4.4.2.3.3=46 ;ibmSpTrapAppS
2.6.158.4.4.2.3.4=47 ;ibmSpTrapPoffS
2.6.158.4.4.2.3.5=48 ;ibmSpTrapPonS
2.6.158.4.4.2.3.6=49 ;ibmSpTrapBootS
2.6.158.4.4.2.3.7=50 ;ibmSpTrapLdrToS
2.6.158.4.4.2.3.8=51 ;ibmSpTrapPFAS
2.6.158.4.4.2.3.9=52 ;ibmSpTrapKVMSwitchS
2.6.158.4.4.2.3.10=53 ;ibmSpTrapSysInvS
2.6.158.4.4.2.3.11=54 ;ibmSpTrapSysLogS
2.6.158.4.4.2.3.12=55 ;ibmSpTrapNwChangeS
2603.5.5.4=56 ;alMemoryUsage
2603.5.5.5=57 ;alDiskUsage
2603.5.5.6=58 ;alTemperature
2603.5.5.15=59 ;alCpuUsage
2603.5.5.17=60 ;alCpuPicoUsage
2603.5.2.6.5.1=61 ;alBypassSetting
2603.5.2.6.5.2=62 ;alPower
2603.5.2.6.5.3=63 ;alFan
2603.5.2.6.5.4=64 ;alRemoteBypass
2603.5.2.6.5.5=65 ;alBypass
2603.5.5.20.2=66 ;alSmpUpdateMsgRate
2603.5.5.20.3=67 ;alSmpNumOfSubs
2603.5.5.20.10=68 ;alHighAvailabilityStatus
2603.5.4.2.1.5.=69 ;alStatLiveConn
2603.5.4.2.1.6.=70 ;alStatNewConn
2603.5.4.2.1.7.=71 ;alStatDropConn
2603.5.4.2.1.8.=72 ;alStatOctetsIn
2603.5.4.2.1.9.=73 ;alStatOctetsOut
2603.5.4.2.1.10.=74 ;alStatOctetsTotal
2603.5.4.2.1.11.=75 ;alStatPacketsIn
2603.5.4.2.1.12.=76 ;alStatPacketsOut
2603.5.4.2.1.13.=77 ;alStatPacketsTotal
2603.5.4.3.=78 ;alStatPipes
2603.5.4.4.=79 ;alStatVCs
2603.5.4.5.=80 ;alStatLines
2603.0.1=81 ;alDeviceConfChangeTrap
2603.0.2=82 ;alCatalogConfChangeTrap
2603.0.3=83 ;alLineConfChangeTrap
2603.0.4=84 ;alPipeConfChangeTrap
2603.0.5=85 ;alVCConfChangeTrap
2603.0.6=86 ;alAlertRisingTrap
2603.0.7=87 ;alAlertFallingTrap
2603.0.8=88 ;alDosAttackOnTrap
2603.0.9=89 ;alDosAttackOffTrap
2603.0.10=90 ;alDataSourceDownTrap
2603.0.11=91 ;alDataSourceUpTrap
2603.0.12=92 ;alSoftwareProblemTrap
2603.0.13=93 ;alAccessViolationTrap
2603.0.14=94 ;alIpAddrConfChangeTrap
2603.0.15=95 ;alConnRouteConfChangeTrap
2603.0.16=96 ;alDeviceStatusUpTrap
2603.0.17=97 ;alDeviceStatusDownTrap
2603.0.18=98 ;alApplicationInfoTrap
2603.0.19=99 ;alBoardStatusChangeTrap
2603.0.20=100 ;alWebUpdateTrap
2603.4.1=101 ;alActivationKey
2603.4.2=102 ;alActivationModel
2603.4.3=103 ;alSysExpirationDate
2603.4.4=104 ;alQoSIsEnabled
2603.4.5=105 ;alQoSExpirationDateEnable
2603.4.6=106 ;alCacheIsEnabled
2603.4.7=107 ;alCacheExpirationDateEnable
2603.4.8=108 ;alLoadBalancingIsEnabled
2603.4.9=109 ;alLoadBalancingExpirationDateEnable
2603.4.10=110 ;alActivationLimits
2603.4.11=111 ;alLTCollectionEnabled
2603.4.12=112 ;alWebUpdateIsEnabled
2603.4.13=113 ;alWebUpdateExpirationDateEnable
2603.4.10.1=114 ;alLinePerPolicy
2603.4.10.2=115 ;alPipePerPolicy
2603.4.10.3=116 ;alVcPerPolicy
2603.4.10.4=117 ;alMaxBandwidth
2603.4.10.5=118 ;alMaxConnections
2603.5.1.1=119 ;alAC200
2603.5.1.2=120 ;alAC400
2603.5.1.3=121 ;alAC800
2603.5.1.4=122 ;alAC1000
2603.5.1.5=123 ;alAC2500
2603.5.1.6=124 ;alMediationDevice
2603.5.1.7=125 ;alSG20
2603.5.1.8=126 ;alAC10K
2603.5.1.9=127 ;alACSigma
2603.5.2.1=128 ;alConfigurationName
2603.5.2.3=129 ;alDoubleSession
2603.5.2.6=130 ;alGeneralSystem
2603.5.2.8=131 ;alGenericLastChangeVar
2603.5.2.9=132 ;alGenericLastChangeIntVal
2603.5.2.10=133 ;alGenericLastChangeTimestamp
2603.5.2.11=134 ;alGenericConfigTrapEnable
2603.5.2.13=135 ;alGenericLastChangeStrVal
2603.5.2.14=136 ;alGenericLastChangeAddrVal
2603.5.2.6.1=137 ;alGeneralSystem
2603.5.2.6.2=138 ;alTimeZone
2603.5.2.6.3=139 ;alfxTable
2603.5.2.6.4=140 ;alSystemNetwork
2603.5.2.6.5=141 ;alSystemStatus
2603.5.2.6.6=142 ;alSystemSecurity
2603.5.2.6.7=143 ;allpXAddrTable
2603.5.2.6.8=144 ;alMode
2603.5.2.6.9=145 ;alLearningBridge
2603.5.2.6.10=146 ;alSPTStatus
2603.5.2.6.11=147 ;alRedundancyMode
2603.5.2.6.12=148 ;alBoxSerialNumber
2603.5.2.6.13=149 ;alSoftwareVersion
2603.5.2.6.14=150 ;alBackplaneVersion
2603.5.2.6.15=151 ;alPosIfTable
2603.5.2.6.16=152 ;alRedundancyCap
2603.5.2.6.17=153 ;alBypassUnit
2603.5.2.6.18=154 ;alDeviceBWLimits
2603.5.2.6.19=155 ;alSystemCOC
2603.5.2.6.20=156 ;alInternalRedundancy
2603.5.2.6.21=157 ;alWebUpdate
2603.5.3.1.3=158 ;alCatalogListTable
2603.5.3.1.4=159 ;alCatalogsTable
2603.5.3.2.3=160 ;alPipeLastChange
2603.5.3.2.4=161 ;alPipeTable
2603.5.3.2.5=162 ;alVCLastChange
2603.5.3.2.6=163 ;alVCTable
2603.5.3.2.7=164 ;alLineConfTrapEnable
2603.5.3.2.8=165 ;alPipeConfTrapEnable
2603.5.3.2.9=166 ;alVCConfTrapEnable
2603.5.3.2.10=167 ;alPolicyModificationTag
2603.5.4.1=168 ;alStatCntlTable
2603.5.4.2=169 ;alStatTable
2603.5.4.3=170 ;alStatPipes
2603.5.4.4=171 ;alStatVCs
2603.5.4.5=172 ;alStatLines
2603.5.5.1=173 ;alDataSourceTable
2603.5.5.2=174 ;alDataSourceLastChange
2603.5.5.3=175 ;alSevereSoftwareProblem
2603.5.5.4=176 ;alMemoryUsage
2603.5.5.5=177 ;alDiskUsage
2603.5.5.6=178 ;alTemperature
2603.5.5.7=179 ;alAlertConfTable
2603.5.5.8=180 ;alAlertLastChange
2603.5.5.9=181 ;alLastAccessViolation
2603.5.5.10=182 ;alAlertsTrapsEnable
2603.5.5.11=183 ;alDataSourceTrapEnable
2603.5.5.12=184 ;alAccessViolationTrapEnable
2603.5.5.13=185 ;allDOSAttackTable
2603.5.5.14=186 ;alDOSTrapEnable
2603.5.5.15=187 ;alCpuUsage
2603.5.5.16=188 ;alLastMessage
2603.5.5.17=189 ;alCpuPicoUsage
2603.5.5.18=190 ;alSensorTable
2603.5.5.20=191 ;alSmpMIB
2603.5.5.21=192 ;alSmpConf
2603.5.5.22=193 ;alSmpTrapConf
2603.5.5.7.1.1=194 ;alAlertConfId
2603.5.5.7.1.2=195 ;alAlertConfVariable
2603.5.5.7.1.3=196 ;alAlertConfValue
2603.5.5.7.1.4=197 ;alAlertConfThreshold
2603.5.5.7.1.5=198 ;alAlertConfNormal
2603.5.5.7.1.6=199 ;alAlertConfRegInterval
2603.5.5.7.1.7=200 ;alAlertConfUnRegInterval
2603.5.5.7.1.8=201 ;alAlertConfThresholdDirection
2603.5.5.18.1.1=202 ;alSensorId
2603.5.5.18.1.2=203 ;alSensorType
2603.5.5.20=204 ;alSmpMIB
2603.5.5.20.1=205 ;alSmpTrap
2603.5.5.20.2=206 ;alSmpUpdateMsgRate
2603.5.5.20.3=207 ;alSmpNumOfSubs
2603.5.5.20.5=208 ;alInitatingProcess
2603.5.5.20.6=209 ;alProvisioningType
2603.5.5.20.7=210 ;alFailCause
2603.5.5.20.8=211 ;alSubscriberName
2603.5.5.20.9=212 ;alSubscriberIp
2603.5.5.20.10=213 ;alHighAvailabilityStatus
2603.5.6.1=214 ;alSaveConfig
2603.5.6.2=215 ;alRestoreConfig
2603.5.6.3=216 ;alPoliciesStatusTable
2603.6.1.1=217 ;alGenericGroup
2603.6.1.2=218 ;alProvisioningGroup
2603.6.1.3=219 ;alStatisticsGroup
2603.6.1.4=220 ;alAlertsGroup
2603.6.1.5=221 ;alLoadGroup
2603.6.1.6=222 ;alEventsGroup
2603.6.2.1=223 ;alCompliance
2603.10.0.1=224 ;alAlarmRisingTrap
2603.10.0.2=225 ;alAlarmFallingTrap
2603.10.2.1=226 ;alAlarmTable
2603.10.2.2=227 ;alTrapCounter
2603.10.3.1=228 ;alGroups
2603.10.3.2=229 ;alCompls


[0001 - allot]
event_type=event
regexp=(\SYSLOG_DATE) (\S+).*?(\d+\.\d+\.\d+\.\d+)\.\d+\.\d+\.(\d+\.\d+\.\d+\.\d+)\.\d+\.\d+\.\d+\.\d+ = STRING: "([^"]+)"
date={normalize_date($1)}
device={resolv($2)}
plugin_sid={translate($3)}
dst_ip={$4}
userdata1={$5}

