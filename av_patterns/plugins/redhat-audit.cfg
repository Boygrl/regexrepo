# Alienvault plugin
# Author: Alienvault Team at devel@alienvault.com
# Plugin redhat-audit id:1704 version: 0.0.1
# Last modification: 2015-07-02 12:00
#
# Plugin Selection Info:
# Red Hat:Audit:-
#
# END-HEADER
#
# Description:
#
# RedHat Audit

[DEFAULT]
plugin_id=1704

[config]
type=detector
enable=yes
source=log
location=/var/log/redhat-audit.log

create_file=false

process=
start=no
stop=no
startup=
shutdown=


[translation]
ADD_GROUP=1
ADD_USER=2
ALL=3
ANOM_ABEND=4
ANOM_ACCESS_FS=5
ANOM_ADD_ACCT=6
ANOM_AMTU_FAIL=7
ANOM_CRYPTO_FAIL=8
ANOM_DEL_ACCT=9
ANOM_EXEC=10
ANOM_LOGIN_ACCT=11
ANOM_LOGIN_FAILURES=12
ANOM_LOGIN_LOCATION=13
ANOM_LOGIN_SESSIONS=14
ANOM_LOGIN_TIME=15
ANOM_MAX_DAC=16
ANOM_MAX_MAC=17
ANOM_MK_EXEC=18
ANOM_MOD_ACCT=19
ANOM_PROMISCUOUS=20
ANOM_RBAC_FAIL=21
ANOM_RBAC_INTEGRITY_FAIL=22
ANOM_ROOT_TRANS=23
APPARMOR=24
APPARMOR_ALLOWED=25
APPARMOR_AUDIT=26
APPARMOR_DENIED=27
APPARMOR_ERROR=28
APPARMOR_HINT=29
APPARMOR_STATUS=30
AVC=31
AVC_PATH=32
BPRM_FCAPS=33
CAPSET=34
CHGRP_ID=35
CHUSER_ID=36
CONFIG_CHANGE=37
CRED_ACQ=38
CRED_DISP=39
CRED_REFR=40
CRYPTO_FAILURE_USER=41
CRYPTO_KEY_USER=42
CRYPTO_LOGIN=43
CRYPTO_LOGOUT=44
CRYPTO_PARAM_CHANGE_USER=45
CRYPTO_REPLAY_USER=46
CRYPTO_SESSION=47
CRYPTO_TEST_USER=48
CWD=49
DAC_CHECK=50
DAEMON_ABORT=51
DAEMON_ACCEPT=52
DAEMON_CLOSE=53
DAEMON_CONFIG=54
DAEMON_END=55
DAEMON_RESUME=56
DAEMON_ROTATE=57
DAEMON_START=58
DEL_GROUP=59
DEL_USER=60
DEV_ALLOC=61
DEV_DEALLOC=62
EOE=63
EXECVE=64
FD_PAIR=65
FS_RELABEL=66
GRP_AUTH=67
INTEGRITY_DATA=68
INTEGRITY_HASH=69
INTEGRITY_METADATA=70
INTEGRITY_PCR=71
INTEGRITY_RULE=72
INTEGRITY_STATUS=73
IPC=74
IPC_SET_PERM=75
KERNEL=76
KERNEL_OTHER=77
LABEL_LEVEL_CHANGE=78
LABEL_OVERRIDE=79
LOGIN=80
MAC_CIPSOV4_ADD=81
MAC_CIPSOV4_DEL=82
MAC_CONFIG_CHANGE=83
MAC_IPSEC_ADDSA=84
MAC_IPSEC_ADDSPD=85
MAC_IPSEC_DELSA=86
MAC_IPSEC_DELSPD=87
MAC_IPSEC_EVENT=88
MAC_MAP_ADD=89
MAC_MAP_DEL=90
MAC_POLICY_LOAD=91
MAC_STATUS=92
MAC_UNLBL_ALLOW=93
MAC_UNLBL_STCADD=94
MAC_UNLBL_STCDEL=95
MQ_GETSETATTR=96
MQ_NOTIFY=97
MQ_OPEN=98
MQ_SENDRECV=99
OBJ_PID=100
PATH=101
RESP_ACCT_LOCK=102
RESP_ACCT_LOCK_TIMED=103
RESP_ACCT_REMOTE=104
RESP_ACCT_UNLOCK_TIMED=105
RESP_ALERT=106
RESP_ANOMALY=107
RESP_EXEC=108
RESP_HALT=109
RESP_KILL_PROC=110
RESP_SEBOOL=111
RESP_SINGLE=112
RESP_TERM_ACCESS=113
RESP_TERM_LOCK=114
ROLE_ASSIGN=115
ROLE_REMOVE=116
SELINUX_ERR=117
SOCKADDR=118
SOCKETCALL=119
SYSCALL=120
SYSTEM_BOOT=121
SYSTEM_RUNLEVEL=122
SYSTEM_SHUTDOWN=123
TEST=124
TRUSTED_APP=125
TTY=126
USER=127
USER_ACCT=128
USER_AUTH=129
USER_AVC=130
USER_CHAUTHTOK=131
USER_CMD=132
USER_END=133
USER_ERR=134
USER_LABELED_EXPORT=135
USER_LOGIN=136
USER_LOGOUT=137
USER_MAC_POLICY_LOAD=138
USER_MGMT=139
USER_ROLE_CHANGE=140
USER_SELINUX_ERR=141
USER_START=142
USER_TTY=143
USER_UNLABELED_EXPORT=144
USYS_CONFIG=145

[0001 - RedHat-Audit - FILE]
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d) (?P<sensor>\S+) \S+ node=(?P<src_ip>\S+) type=(?P<sid>\S+).*?(name|exe|cwd)="(?P<filename>[^"]+)"
date={normalize_date($date)}
sensor={resolv($sensor)}
src_ip={resolv($src_ip)}
plugin_sid={translate($sid)}
filename={$filename}

[0099 - RedHat-Audit - Generic]
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d) (?P<sensor>\S+) \S+ node=(?P<src_ip>\S+) type=(?P<sid>\S+)"
date={normalize_date($date)}
sensor={resolv($sensor)}
src_ip={resolv($src_ip)}
plugin_sid={translate($sid)}

