# Alienvault plugin
# Author: Alienvault Team at devel@alienvault.com
# Plugin bomgar id:1799 version: 0.0.1
# Last modification: 2016-10-14 14:30
#
# Plugin Selection Info:
# Bomgar:Remote Support and Privileged Access:-
#
# Description:
#
#
#

[DEFAULT]
plugin_id=1799


[config]
type=detector
enable=yes

source=log
location=/var/log/bomgar.log

create_file=true

process=
start=no
stop=no
startup=
shutdown=


[translation]
access_sponsor_group_added = 1
access_sponsor_group_changed = 2
access_sponsor_group_member_added = 3
access_sponsor_group_member_changed = 4
access_sponsor_group_member_removed = 5
access_sponsor_group_removed = 6
admin_password_reset_to_factory_default = 7
backup_created = 8
bomgar_button_profile_added = 9
bomgar_button_profile_changed = 10
bomgar_button_profile_icon_uploaded = 11
bomgar_button_profile_removed = 12
canned_message_added = 13
canned_message_category_added = 14
canned_message_cateogry_changed = 15
canned_message_category_removed = 16
canned_message_changed = 17
canned_message_removed = 18
canned_message_team_added = 19
canned_message_team_changed = 20
canned_message_team_removed = 21
canned_script_added = 22
canned_script_category_added = 23
canned_script_category_removed = 24
canned_script_changed = 25
canned_script_file_added = 26
canned_script_file_removed = 27
canned_script_removed = 28
canned_script_team_added = 29
canned_script_team_removed = 30
canned_scripts_category_added = 31
canned_scripts_category_removed = 32
canned_scripts_file_added = 33
canned_scripts_file_removed = 34
certificate_export = 35
change_display_name = 36
change_password = 37
change_username = 38
cust_exit_survey_question_added = 39
cust_exit_survey_question_changed = 40
cust_exit_survey_question_option_added = 41
cust_exit_survey_question_option_changed = 42
cust_exit_survey_question_option_removed = 43
cust_exit_survey_question_removed = 44
custom_rep_link_added = 45
custom_rep_link_changed = 46
custom_rep_link_removed = 47
custom_session_attribute_added = 48
custom_session_attribute_changed = 49
custom_session_attribute_removed = 50
custom_session_policy_added = 51
custom_session_policy_changed = 52
custom_session_policy_removed = 53
custom_special_action_added = 54
custom_special_action_changed = 55
custom_special_action_removed = 56
customer_notice_added = 57
customer_notice_changed = 58
customer_notice_public_site_added = 59
customer_notice_public_site_removed = 60
customer_notice_removed = 61
customizable_text_changed = 62
default_site_changed = 63
downloaded_rep_client = 64
embassy_added = 65
embassy_changed = 66
embassy_issue_added = 67
embassy_issue_removed = 68
embassy_member_added = 69
embassy_member_removed = 70
embassy_removed = 71
embassy_setting_added = 72
embassy_setting_changed = 73
embassy_setting_removed = 74
embassy_user_added = 75
embassy_user_changed = 76
embassy_user_removed = 77
file_removed_from_file_store = 78
file_uploaded_to_file_store = 79
group_policy_added = 80
group_policy_changed = 81
group_policy_member_added = 82
group_policy_member_removed = 83
group_policy_removed = 84
group_policy_setting_added = 85
group_policy_setting_changed = 86
group_policy_setting_removed = 87
ios_content_item_added = 88
ios_content_item_changed = 89
ios_content_item_removed = 90
jump_policy_added = 91
jump_policy_changed = 92
jump_policy:schedule_entry_added = 93
jump_policy:schedule_entry_removedIbid. = 94
jump_policy_removed = 95
jumpoint_cluster_added = 96
jumpoint_cluster_changed = 97
jumpoint_cluster_removed = 98
jumpoint_user_added = 99
jumpoint_user_removed = 100
kerberos_keytab_added = 101
kerberos_keytab_removed = 102
license_pool_added = 103
license_pool_changed = 104
license_pool_removed = 105
license_usage_report_generated = 106
login = 107
login_schedule_entry_added = 108
login_schedule_entry_removed = 109
logout = 110
network_address_added = 111
network_address_changed = 112
network_address_removed = 113
network_changed = 114
network_route_changed = 115
outbound_event_email_recipient_added = 116
outbound_event_email_recipient_changed = 117
outbound_event_email_recipient_removed = 118
outbound_event_email_trigger_added = 119
outbound_event_email_trigger_removed = 120
outbound_event_http_recipient_added = 121
outbound_event_http_recipient_changed = 122
outbound_event_http_recipient_removed = 123
outbound_event_http_trigger_added = 124
outbound_event_http_trigger_removed = 125
pdcust_banner_reverted_to_factory_default = 126
pdcust_banner_uploaded = 127
presentation_session_detail_generated = 128
presentation_session_report_generated = 129
public_site_added = 130
public_site_address_added = 131
public_site_address_removed = 132
public_site_changed = 133
public_site_customer_banner_reverted_to_factory_default = 134
public_site_customer_banner_uploaded = 135
public_site_exit_survey_added = 136
public_site_exit_survey_removed = 137
public_site_removed = 138
public_site_setting_added = 139
public_site_setting_changed = 140
public_site_team_added = 141
public_site_team_removed = 142
public_site_template_asset_uploaded = 143
public_site_template_asset_reverted = 144
public_template_deleted = 145
public_template_written = 146
reboot = 147
rep_client_connection_terminated = 148
rep_console_setting_added = 149
rep_console_setting_changed = 150
rep_console_setting_removed = 151
rep_exit_survey_question_added = 152
rep_exit_survey_question_changed = 153
rep_exit_survey_question_option_added = 154
rep_exit_survey_question_option_changed = 155
rep_exit_survey_question_option_removed = 156
rep_exit_survey_question_removed = 157
rep_invite_added = 158
rep_invite_removed = 159
repinvite_setting_added = 160
repinvite_setting_removed = 161
restored_from_backup = 162
restoring_from_backup = 163
sdcust_exit_survey_report_generated = 164
sdrep_exit_survey_report_generated = 165
security_provider_added = 166
security_provider_changed = 167
security_provider_removed = 168
security_provider_setting_added = 169
security_provider_setting_changed = 170
security_provider_setting_removed = 171
session_policy_added = 172
session_policy_changed = 173
session_policy_removed = 174
server_software_restarted = 175
setting_added = 176
setting_changed = 177
skill_added = 178
skill_changed = 179
skill_removed = 180
SNMP_changed = 181
starting_support_tunnel = 182
support_issue_added = 183
support_issue_changed = 184
support_issue_removed = 185
support_issue_skill_added = 186
support_issue_skill_removed = 187
support_session_detail_generated = 188
support_session_report_generated = 189
support_session_summary_report_ = 190
support_team_added = 191
support_team_changed = 192
support_team_jump_access_added = 193
support_team_jump_access_removed = 194
support_team_member_added = 195
support_team_member_changed = 196
support_team_member_removed = 197
support_team_removed = 198
syslog_server_changed = 199
team_activity_report_generated = 200
user_account_report_generated = 201
user_added = 202
user_changed = 203
user_removed = 204
user_session_policy_added = 205
user_session_policy_removed = 206
user_skill_added = 207
user_skill_removed = 208

#   Default
_DEFAULT_=20000000


#########################
#         RULES         #
#########################

[0001 - Bomgar - Rule 1]
event_type=event
#precheck=""
regexp="(?P<sys_date>\w+\s*\d+\s*\d+:\d+:\d+)\s*(?P<device>\S+)\s*BG\s*(?P<site_id>\d+):(?P<segment_number>\d+):(?P<total_segments>\d+):(?:event=(?P<sid>[^;\s]*);?|site=(?:https?://)?(?:w{3}\.)?(?P<dst>[^;/]*)(?:/[^;]*)?;?|when=(?P<date_timestamp>[^;]*);?|who=(?P<name_surname>.*?)\s*\((?P<username>[^\)]*)\)\s*(?P<method_used>using \w+)?;?|status=(?P<result>[^;]*);?|who_ip=(?P<src_ip>[^;]*);?|target=(?P<target_type>[^;]*);?|lsid=(?P<lsid>[^;]*);?|only_completed=(?P<only_completed>[^;]*);?|api=(?P<api>[^;]*);?|session_count=(?P<session_count>[^;]*);?|reason=(?P<reason>[^;]*);?)*"
date={normalize_date($date_timestamp)}
plugin_sid={translate($sid)}
device={resolv($device)}
src_ip={resolv($src_ip)}
dst_ip={resolv($dst)}
username={$name_surname}
userdata1={$site_id}
userdata2={$username}
userdata3={$target_type}
userdata4={$reason}
userdata5={$result}
userdata6={$api}
userdata7={$only_completed}
userdata8={$session_count}
userdata9={$method_used}