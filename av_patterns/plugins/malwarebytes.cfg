# Alienvault plugin
# Author: Alienvault Team at devel@alienvault.com
# Plugin malwarebytes id:1769 version: 0.0.1
# Last modification: 2016-07-13 14:30
#
# Plugin Selection Info:
# Malwarebytes:Malwarebytes:-
#
# END-HEADER
#
# Accepted products:
# Malwarebytes Anti-Malware (MEE) - version 1.80.1.1011
# Malwarebytes Anti-Exploit - version 1.08.2.2563
#
# Description:
#


[DEFAULT]
plugin_id=1769


[config]
type=detector
enable=yes

source=log
location=/var/log/malwarebytes.log

create_file=false

process=
start=no
stop=no
startup=
shutdown=


[translation]
#   Rule 1 SIDS
Exploit payload file blocked=1
Exploit payload process blocked=2
Exploit attempt blocked=3
Java exploit attempt blocked=4
PUP.Optional.ASK=5
Blocked web site=6
#   Default
_DEFAULT_= 20000000

[0001 - malwarebytes]
event_type=event
regexp="(?P<date>\w+\s+\d+\s+\d+:\d+:\d+)\s+(?P<device>\S+)\sMalwarebytes\S+\s.*?client_id":"(?P<client_id>[^"]*)","host_name"."(?P<hostname>[^"]*)","domain":"(?P<domain>[^"]*)","mac_address":"(?P<mac_address>[^"]*)","ip_address":"(?P<src_ip>[^"]*)","time":"(?P<date_log>[^"]+"),"threat_level":"(?P<threat_level>[^"]*)","object_type":"(?P<object_type>[^"]*)","object":"(?P<object>[^"]*)","threat_name":"(?P<threat_name>[^"]*)","action":"(?P<action>[^"]*)","operation":"(?P<operation>[^"]*)","resolved":(?P<resolved>true|false),"logon_user":"(?P<user>[^"]*)","data":"(?P<data>[^"]*)","description":"(?P<description>.*?(?:(?P<ip>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}).*?Port:\s*(?P<port>\d+))?[^"]*)","source":"(?P<source>[^"]*)","payload":(?:null|"(?P<payload>[^"]*)"),"payload_url":(?:null|"(?P<payload_url>[^"]*)"),"payload_process":(?:null|"(?P<payload_process>[^"]*)"),"application_path":(?:null|"(?P<application_path>[^"]*)"),"application":(?:null|"(?P<application>[^"]*)")"
date={normalize_date($date_log)}
plugin_sid={translate($threat_name)}
device={resolv($device)}
src_ip={resolv($src_ip)}
dst_ip={resolv($ip)}
dst_port={$port}
username={$user}
filename={$application_path}
userdata1={$client_id}
userdata2={$hostname}
userdata3={$domain}
userdata4={$mac_address}
userdata5={$threat_level}
userdata6={$action}
userdata7={$source}
userdata8={$application}
userdata9={$object_type}
