# Alienvault plugin
# Author: Alienvault Team at devel@alienvault.com
# Plugin fw1-alt id:1590 version: 0.0.10
# Last modification: 2016-09-07 11:50
#
# Plugin Selection Info:
# Check Point:FireWall:-
#
# END-HEADER
# Accepted products:
# checkpoint - firewall-1 3.0
# checkpoint - firewall-1 3.0b
# checkpoint - firewall-1 4.0
# checkpoint - firewall-1 4.1
# checkpoint - firewall-1 4.1_build_41439
# checkpoint - firewall-1 r55w
# checkpoint - firewall-1 r77
# checkpoint - firewall-1 r77.30
# checkpoint - firewall-4800
# Description:
#
#
#

[DEFAULT]
plugin_id=1590

[config]
type=detector
enable=yes

source=log
location=/var/log/syslog-ng/fw1.log

create_file=false

process=syslog
start=no
stop=no
startup=
shutdown=

[translation]
tcpmux=1
echo=7
discard=9
systat=11
daytime=13
netstat=15
qotd=17
msp=18
chargen=19
ftp-data=20
ftp=21
fsp=21
ssh=22
telnet=23
smtp=25
time=37
rlp=39
nameserver=42
whois=43
tacacs=49
re-mail-ck=50
domain-udp=53
domain-tcp=53
mtp=57
tacacs-ds=65
bootps=67
bootpc=68
tftp=69
gopher=70
rje=77
finger=79
www=80
http_clean=80
link=87
kerberos=88
supdup=95
hostnames=101
iso-tsap=102
acr-nema=104
csnet-ns=105
rtelnet=107
pop2=109
pop3=110
sunrpc=111
auth=113
sftp=115
uucp-path=117
nntp=119
ntp=123
pwdgen=129
loc-srv=135
netbios-ns=137
netbios-dgm=138
netbios-ssn=139
imap2=143
snmp=161
snmp-trap=162
cmip-man=163
cmip-agent=164
mailq=174
xdmcp=177
nextstep=178
bgp=179
prospero=191
irc=194
smux=199
at-rtmp=201
at-nbp=202
at-echo=204
at-zis=206
qmtp=209
z3950=210
ipx=213
imap3=220
pawserv=345
zserv=346
fatserv=347
rpc2portmap=369
codaauth2=370
clearcase=371
ulistserv=372
ldap=389
imsp=406
svrloc=427
https=443
snpp=444
microsoft-ds=445
kpasswd=464
saft=487
isakmp=500
rtsp=554
nqs=607
npmp-local=610
npmp-gui=611
hmmp-ind=612
qmqp=628
ipp=631
exec=512
biff=512
login=513
who=513
shell=514
syslog=514
printer=515
talk=517
ntalk=518
route=520
timed=525
tempo=526
courier=530
conference=531
netnews=532
netwall=533
gdomap=538
uucp=540
klogin=543
kshell=544
dhcpv6-client=546
dhcpv6-server=547
afpovertcp=548
idfp=549
remotefs=556
nntps=563
submission=587
ldaps=636
tinc=655
silc=706
kerberos-adm=749
webster=765
rsync=873
ftps-data=989
ftps=990
telnets=992
imaps=993
ircs=994
pop3s=995
socks=1080
proofd=1093
rootd=1094
openvpn=1194
rmiregistry=1099
kazaa=1214
nessus=1241
lotusnote=1352
ms-sql-s=1433
ms-sql-m=1434
ingreslock=1524
prospero-np=1525
datametrics=1645
sa-msg-port=1646
kermit=1649
l2f=1701
radius=1812
radius-acct=1813
msnp=1863
unix-status=1957
log-server=1958
remoteping=1959
cisco-sccp=2000
search=2010
pipe_server=2010
nfs=2049
gnunet=2086
rtcm-sc104=2101
gsigatekeeper=2119
gris=2135
cvspserver=2401
venus=2430
venus-se=2431
codasrv=2432
codasrv-se=2433
mon=2583
dict=2628
gsiftp=2811
gpsd=2947
gds_db=3050
icpv2=3130
mysql=3306
nut=3493
distcc=3632
daap=3689
svn=3690
suucp=4031
sysrqd=4094
sieve=4190
epmd=4369
remctl=4373
iax=4569
mtn=4691
radmin-port=4899
rfe=5002
mmcc=5050
sip=5060
sip-tls=5061
aol=5190
xmpp-client=5222
xmpp-server=5269
cfengine=5308
mdns=5353
postgresql=5432
freeciv=5556
amqp=5672
ggz=5688
x11=6000
x11-1=6001
x11-2=6002
x11-3=6003
x11-4=6004
x11-5=6005
x11-6=6006
x11-7=6007
gnutella-svc=6346
gnutella-rtr=6347
sge_qmaster=6444
sge_execd=6445
mysql-proxy=6446
afs3-fileserver=7000
afs3-callback=7001
afs3-prserver=7002
afs3-vlserver=7003
afs3-kaserver=7004
afs3-volser=7005
afs3-errors=7006
afs3-bos=7007
afs3-update=7008
afs3-rmtsys=7009
font-service=7100
http-alt=8080
bacula-dir=9101
bacula-fd=9102
bacula-sd=9103
xmms2=9667
nbd=10809
zabbix-agent=10050
zabbix-trapper=10051
amanda=10080
hkp=11371
bprd=13720
bpdbm=13721
bpjava-msvc=13722
vnetd=13724
bpcd=13782
vopied=13783
dcap=22125
gsidcap=22128
wnn6=22273
rtmp=1
nbp=2
echo=4
zip=6
kerberos4=750
kerberos_master=751
passwd_server=752
krb_prop=754
krbupdate=760
swat=901
kpop=1109
knetd=2053
zephyr-srv=2102
zephyr-clt=2103
zephyr-hm=2104
eklogin=2105
kx=2111
iprop=2121
supfilesrv=871
supfiledbg=1127
linuxconf=98
poppassd=106
ssmtp=465
moira_db=775
moira_update=777
moira_ureg=779
spamd=783
omirr=808
customs=1001
skkserv=1178
predict=1210
rmtcfg=1236
wipld=1300
xtel=1313
xtelw=1314
support=1529
cfinger=2003
frox=2121
ninstall=2150
zebrasrv=2600
zebra=2601
ripd=2602
ripngd=2603
ospfd=2604
bgpd=2605
ospf6d=2606
ospfapi=2607
isisd=2608
afbackup=2988
afmbackup=2989
xtell=4224
fax=4557
hylafax=4559
distmp3=4600
munin=4949
enbd-cstatd=5051
enbd-sstatd=5052
pcrd=5151
noclog=5354
hostmon=5355
rplay=5555
nrpe=5666
nsca=5667
mrtd=5674
bgpsim=5675
canna=5680
sane-port=6566
ircd=6667
zope-ftp=8021
tproxy=8081
omniorb=8088
clc-build-daemon=8990
xinetd=9098
mandelspawn=9359
git=9418
zope=9673
webmin=10000
kamanda=10081
amandaidx=10082
amidxtape=10083
smsqp=11201
xpilot=15345
sgi-cmsd=17001
sgi-crsd=17002
sgi-gcd=17003
sgi-cad=17004
isdnlog=20011
vboxd=20012
binkp=24554
asp=27374
csync2=30865
dircproxy=57000
tfido=60177
fido=60179
URL Filtering=30000
Application Control=30001
_DEFAULT_=0

[fw_actions]
drop=1
authorize=2
deauthorize=3
reject=4
ctl=5
alert=6
accept=7
allow=8
monitor=9
encrypt=10
decrypt=11
block=12
keyinst=13
authcrypt=14
update=15
logout=16
authcrypt_failed=17
Agent is up=20
HTTPS Bypass=21
prevent=22
HTTPS Inspect=23
redirect=24

[0001 - fw1 R77.30]
event_type=event
precheck=";"
regexp="(?P<syslog_date>\S+\s+\d+\s+\d+:\d+:\d+)\s+\S+\s+\S+\s+(?P<date>\S+\s+\d+:\d+:\d+)\s+(?P<fw_action>(?:drop|lo|logout|authorize|deauthorize|reject|ctl|alert|accept|allow|monitor|encrypt|decrypt|block|keyinst|authcrypt|authcrypt_failed|update|HTTPS Bypass|prevent|HTTPS Inspect|redirect))\s+(?P<device>\S+)\s+(?:<|>)(?P<iface>\S+)?;?\s+(?:\s*;?src:\s*(?P<src_ip>[^;]*);?|\s*(?:dst|endpoint_ip):\s*(?P<dst_ip>[^;]*);?|\s*proto:\s*(?P<proto>[^;]*);?|\s*rule_name:\s*(?P<rule_name>[^;]*);?|\s*message_info:\s*(?P<message_info>[^;]*);?|\s*service:\s*(?P<service>\d+);?|\s*s_port:\s*(?P<s_port>\d+);?|\s*service:\s*(?P<service_notnum>[^;]*);?|\s*s_port:\s*(?P<s_port_notnum>[^;]*);?|\s*policy:\s*(?P<policy>[^;]*);?|\s*matched_category:\s*(?P<matched_category>[^;]*);?|\s*user:\s*(?P<user>[^;]*);?|\s*attack:\s*(?P<attack>[^;]*);?|\s*Attack\s+Info:\s*(?P<attack_info>[^;]*);?|[^:]*:[^;]*;?)+"
date={normalize_date($date)}
plugin_sid={translate2($fw_action,$fw_actions)}
device={resolv($device)}
src_ip={resolv($src_ip)}
dst_ip={resolv($dst_ip)}
src_port={$s_port}
dst_port={$service}
protocol={normalize_protocol($proto)}
username={$user}
userdata1={$iface}
userdata2={$service_notnum}
userdata3={$s_port_notnum}
userdata4={$rule_name}
userdata5={$policy}
userdata6={$message_info}
userdata7={$attack}
userdata8={$attack_info}
userdata9={$matched_category}

[0002 - R77.30 Action blankspace]
event_type=event
precheck="Action=" ""
regexp="(?P<syslog_date>\S+\s+\d+\s+\d+:\d+:\d+).*?(?P<device>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*?(?:Action|\s+StormAgentAction)="(?P<fw_action>[^"])"(?:\s+UUid="(?P<uuid>[^"]*)"?|\s+StormAgentName="(?P<agent_name>[^"]*)"?|\s+rule="(?P<rule>[^"]*)"?|\s+rule_uid="(?P<rule_uid>[^"]*)"?|\s+service_id="(?P<service_id>[^"]*)"?|\s+src="(?P<src>[^"]*)"?|\s+dst="(?P<dst>[^"]*)"?|\s+proto="(?P<proto>[^"]*)"?|\s+message_info="(?P<msg_info>[^"]*)"?|\s+xlatesrc="(?P<xlatesrc>[^"]*)"?|\s+NAT_rulenum="(?P<nat_rulenum>[^"]*)"?|\s+NAT_addtnl_rulenum="(?P<addtln_rulenum>[^"]*)"?|\s+product="(?P<product>[^"]*)"?|\s+service="(?P<service>[^"]*)"?|\s+s_port="(?P<s_port>[^"]*)"?|\s+xlatesport="(?P<xlatesport>[^"]*)"?|\s+product_family="(?P<family>[^"]*)"?|\s*[^=]*="[^"]*")+"
date={normalize_date($syslog_date)}
plugin_sid=200000000
device={resolv($device)}
src_ip={resolv($src)}
dst_ip={resolv($dst)}
src_port={$s_port}
dst_port={$service}
protocol={normalize_protocol($proto)}
userdata1={$uuid}
userdata2={$xlatesrc}
userdata3={$nat_rulenum}
userdata4={$addtln_rulenum}
userdata5={$product}
userdata6={$msg_info}
userdata7={$service}
userdata8={$xlatesport}
userdata9={$family}

[0003 - R77.30 complete action]
event_type=event
precheck="Action"
regexp="(?P<syslog_date>\S+\s+\d+\s+\d+:\d+:\d+).*?(?P<device>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*?(?:Action|\s+StormAgentAction)="(?P<fw_action>[^"]*)"?(?:\s+UUid=\s*"(?P<uuid>.*?)"|\s+ICMP="(?P<icmp>[^"]*)"?|\s+client_name="(?P<client_name>[^"]*)"?|\s+client_version="(?P<version>[^"]*)"?|\s+user="(?P<user>[^"]*)"?|\s+domain_name="(?P<domain>[^"]*)"?|\s+StormAgentName="(?P<agent_name>[^"]*)"?|\s+rule="(?P<rule>[^"]*)"?|\s+rule_uid="(?P<rule_uid>[^"]*)"?|\s+service_id="(?P<service_id>[^"]*)"?|\s+TCP packet out of state="[^"]*"?|\s+tcp_flags="(?P<flags>[^"]*)"?|\s+src="(?P<src>[^"]*)"?|\s+(?:dst|endpoint_ip)="(?P<dst>[^"]*)"?|\s+auth_status="(?P<auth_status>[^"]*)"?|\s+identity_src="(?P<id_src>[^"]*)"?|\s+snid="(?P<snid>[^"]*)"?|\s+duration="(?P<duration>[^"]*)"?|\s+description="(?P<descr>[^"]*)"?|\s+src_user_name="(?P<username>[^"]*)"?|\s+src_machine_name="(?P<src_machine>[^"]*)"?|\s+src_user_group="(?P<user_group>[^"]*)"?|\s+src_machine_group="(?P<machine_group>[^"]*)"?|\s+auth_method="(?P<method>[^"]*)"?|\s+identity_type="(?P<id_type>[^"]*)"|\s+proto="(?P<proto>[^"]*)"?|\s+ICMP Type="(?P<icmp_type>[^"]*)"?|\s+ICMP Code="(?P<code>[^"]*)"|\s+message_info="(?P<msg_info>[^"]*)"?|\s+xlatesrc="(?P<xlatesrc>[^"]*)"?|\s+NAT_rulenum="(?P<nat_rulenum>[^"]*)"?|\s+NAT_addtnl_rulenum="(?P<addtln_rulenum>[^"]*)"?|\s+product="(?P<product>[^"]*)"?|\s+service="(?P<service>[^"]*)"?|\s+s_port="(?P<s_port>[^"]*)"?|\s+xlatesport="(?P<xlatesport>[^"]*)"?|\s+product_family="(?P<family>[^"]*)"?|\s+inzone="(?P<inzone>[^"]*)"?|\s+outzone="(?P<outzone>[^"]*)"?|\s+scheme:="(?P<scheme>[^"]*)"?|\s+xlatedst="(?P<xlatedst>[^"]*)"?|\s+methods:="(?P<methods>[^"]*)"?|\s+peer gateway="(?P<peer_gateway>[^"]*)"?|\s+community="(?P<community>[^"]*)"?|\s+vpn_user="(?P<vpn_user>[^"]*)"?|\s+session_uid="(?P<session_uid>[^"]*)"?|\s*[^=]*="[^"]*")+"
date={normalize_date($syslog_date)}
plugin_sid={translate2($fw_action,$fw_actions)}
device={resolv($device)}
src_ip={resolv($src)}
dst_ip={resolv($dst)}
src_port={$s_port}
dst_port={$service}
protocol={normalize_protocol($proto)}
username={$username}
userdata1={$auth_status}
userdata2={$xlatesrc}
userdata3={$nat_rulenum}
userdata4={$addtln_rulenum}
userdata5={$product}
userdata6={$msg_info}
userdata7={$service}
userdata8={$xlatesport}
userdata9={$family}

[0004 - R77.30 No action]
event_type=event
regexp="(?P<syslog_date>\S+\s+\d+\s+\d+:\d+:\d+).*?(?P<device>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*?(?:(?:Action|\s+StormAgentAction)="(?P<fw_action>[^"]*)"?|\s+UUid="(?P<uuid>[^"]*)"?|\s+StormAgentName="(?P<agent_name>[^"]*)"?|\s+rule="(?P<rule>[^"]*)"?|\s+rule_uid="(?P<rule_uid>[^"]*)"?|\s+service_id="(?P<service_id>[^"]*)"?|(?:\s+src="|\s+description=".*?at\s*)(?P<src>[^"\s]*)[^"]*"?|\s+dst="(?P<dst>[^"]*)"?|\s+proto="(?P<proto>[^"]*)"?|\s+message_info="(?P<msg_info>[^"]*)"?|\s+xlatesrc="(?P<xlatesrc>[^"]*)"?|\s+NAT_rulenum="(?P<nat_rulenum>[^"]*)"?|\s+NAT_addtnl_rulenum="(?P<addtln_rulenum>[^"]*)"?|\s+product="(?P<product>[^"]*)"?|\s+service="(?P<service>[^"]*)"?|\s+s_port="(?P<s_port>[^"]*)"?|\s+xlatesport="(?P<xlatesport>[^"]*)"?|\s+product_family="(?P<family>[^"]*)"?)+"
date={normalize_date($syslog_date)}
plugin_sid=200000000
device={resolv($device)}
src_ip={resolv($src)}
dst_ip={resolv($dst)}
src_port={$s_port}
dst_port={$service}
protocol={normalize_protocol($proto)}
userdata1={$uuid}
userdata2={$xlatesrc}
userdata3={$nat_rulenum}
userdata4={$addtln_rulenum}
userdata5={$product}
userdata6={$msg_info}
userdata7={$service}
userdata8={$xlatesport}
userdata9={$family}

[0005 - fw1 malicious file]
event_type=event
precheck="verdict"
regexp="(?P<date>\w{3}\s\d+\s\d+:\d+:\d+)\s*(?P<device>\S+)\s*\S+:?\s*_type:(?P<filetype>[^;]*);file_size:(?P<file_size>\d+);file_md5:(?P<md5>[^;]*);file_sha1:(?P<sha1>[^;]*);file_sha256:(?P<sha256>[^;]*);verdict:(?P<verdict>[^;]*);analyzed_on:(?P<analyzed_on>[^;]*);detected_on:(?P<software>[^;]*);TE_verdict_determined_by:(?P<det_by>[^;]*);Protection Name:(?P<prot_name>[^;]*);Protection Type:(?P<p_type>[^;]*);severity:(?P<severity>[^;]*);malware_action:(?P<malware_action>[^;]*);Confidence Level:(?P<conf_level>[^;]*);packet_capture_unique_id:(?P<paquet_id>[^;]*);product:(?P<product>[^;]*);service:(?P<service>[^;]*);s_port:(?P<src_port>[^;]*);product_family:(?P<family>.*)"
date={normalize_date($date)}
plugin_sid=25
device={resolv($device)}
src_ip={resolv($device)}
src_port={$src_port}
userdata1={$filetype}
userdata2={$verdict}
userdata3={$analyzed_on}
userdata4={$p_type}
userdata5={$severity}
userdata6={$prot_name}
userdata7={$family}
userdata8={$sha1}
userdata9={$malware_action}

[0010 - fw1_alert v2 s_port]
event_type=event
precheck="alert"
regexp="^(?:\w{3}\s+\d{1,2}\s\d{1,2}:\d\d:\d\d)\s([^\s]+)\s+\S+\s+(?P<date>\d{1,2}\w{3}\d{4}\s+\d{1,2}:\d\d:\d\d)\s+(?:\S+\s+)*?alert\s+(?:[^\;]+;\s)*?Industry\sReference:\s(?P<cve>[^\;]+);(?:[^\;]+;\s)*?Attack\sInfo:\s([^\;]+);\sattack:\s([^\;]+);(?:[^\;]+;\s)*?proto:\s([^\;]+);\sdst:\s([^\;]+);\ssrc:\s([^\;]+);(?:[^\;]+;\s)*?s_port:\s([^\;]+)"
date={normalize_date($date)}
plugin_sid=6
device={resolv($1)}
src_ip={resolv($8)}
dst_ip={resolv($7)}
src_port={resolv_port($9)}
protocol={$6}
userdata1={$5}
userdata2={$4}
userdata3={$cve}

[0011 - fw1_alert v2 no s_port]
event_type=event
precheck="alert"
regexp="^(?:\w{3}\s+\d{1,2}\s\d{1,2}:\d\d:\d\d)\s([^\s]+)\s+\S+\s+(?P<date>\d{1,2}\w{3}\d{4}\s+\d{1,2}:\d\d:\d\d)\s+(?:\S+\s+)*?alert\s+(?:[^\;]+;\s)*?Industry\sReference:\s(?P<cve>[^\;]+);(?:[^\;]+;\s)*?Attack\sInfo:\s([^\;]+);\sattack:\s([^\;]+);(?:[^\;]+;\s)*?proto:\s([^\;]+);\sdst:\s([^\;]+);\ssrc:\s([^\;]+)"
date={normalize_date($date)}
plugin_sid=6
device={resolv($1)}
src_ip={resolv($8)}
dst_ip={resolv($7)}
protocol={$6}
userdata1={$5}
userdata2={$4}
userdata3={$cve}

[0012 - fw1_deauthorize]
event_type=event
precheck="deauthorize"
regexp="^(?:\w{3}\s+\d{1,2}\s\d{1,2}:\d\d:\d\d)\s([^\s]+)\s+\S+\s+(?P<date>\d{1,2}\w{3}\d{4}\s+\d{1,2}:\d\d:\d\d)\s+deauthorize\s+([^\s]+)\s([^\s]+)\ssrc:\s([^\;]+);\srule:\s([^\;]+);\sproto:\s([^\;]+);\sauth_method:\s([^\;]+);.*user:\s([^\;]+);.*?service:\s([^\;]+);\ss_port:\s([^\;]+);"
date={normalize_date($date)}
plugin_sid=3
device={resolv($3)}
src_ip={resolv($5)}
protocol={$7}
src_port={resolv_port($11)}
userdata1={$4}
userdata2={$6}
userdata3={$8}
userdata4={$9}
userdata5={$10}

[0013 - fw1_authorize]
event_type=event
precheck="authorize"
regexp="^(?:\w{3}\s+\d{1,2}\s\d{1,2}:\d\d:\d\d)\s([^\s]+)\s+\S+\s+(?P<date>\d{1,2}\w{3}\d{4}\s+\d{1,2}:\d\d:\d\d)\s+authorize\s+([^\s]+)\s([^\s]+)\ssrc:\s([^\;]+);\srule:\s([^\;]+);\sproto:\s([^\;]+);\sauth_method:\s([^\;]+);.*user:\s([^\;]+);.*?service:\s([^\;]+);\ss_port:\s([^\;]+);"
date={normalize_date($date)}
plugin_sid=2
device={resolv($3)}
src_ip={resolv($5)}
protocol={$7}
src_port={resolv_port($11)}
userdata1={$4}
userdata2={$6}
userdata3={$8}
userdata4={$9}
userdata5={$10}

[0020 - 4800scan]
event_type=event
precheck="scan"
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{1,2}:\d\d:\d\d)\s(?P<device>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+\S+\s+\S+\s+\S+\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+>\S+\s+log_id:(?P<log_id>[^;]*);status:(?P<status>[^;]*);(short_desc:(?P<short_desc>[^;]*);)?scan_hosts_hour:(?P<scan_hour>[^;]*);scan_hosts_day:(?P<scan_day>[^;]*);scan_hosts_week:(?P<scan_week>[^;]*);unique_detected_hour:(?P<det_hour>[^;]*);unique_detected_day:(?P<det_day>[^;]*);unique_detected_week:(?P<det_week>[^;]*);scan_mail:(?P<scan_mail>[^;]*);product:(?P<product>[^;]*);product_family:(?P<product_family>[^;]*)"
date={normalize_date($date)}
plugin_sid=18
device={resolv($device)}
src_ip={resolv($device)}
dst_ip={resolv($dst_ip)}
userdata1={$log_id}
userdata2={$status}
userdata3={$scan_hour}
userdata4={$scan_day}
userdata5={$scan_week}
userdata6={$det_hour}
userdata7={$det_day}
userdata8={$product_family}
userdata9={$product}

[0021 - 4800 scan - per type]
event_type=event
precheck="file_type"
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{1,2}:\d\d:\d\d)\s(?P<device>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+\S+\s+\S+\s+\S+\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+>\s*log_id:(?P<log_id>[^;]*);file_type:(?P<file_type>[^;]*);scanned:(?P<scanned>[^;]*);(?:[^;]*;)*?malware_detected:(?P<malware_detected>\d+);(?:[^;]*;)*?threatcloud_scanned:(?P<threatcloud>[^;]*);(?:[^;]*;)*?threatcloud_malware:(?P<threat_cloud_malware>[^;]*);(?:[^;]*;)*?filter_by_static_analysis:(?P<filter>\d+);(?:[^;]*;)*?cache_hit_rate:(?P<cache_hit_rate>\d+);(?:[^;]*;)*?error_count:(?P<error_count>\d+);(?:[^;]*;)*?no_resource_count:(?P<res_count>\d+);(?:[^;]*;)*?product:(?P<product>[^;]*);(?:[^;]*;)*?product_family:(?P<family>.*)"
date={normalize_date($date)}
plugin_sid=18
device={resolv($device)}
src_ip={resolv($device)}
dst_ip={resolv($dst_ip)}
userdata1={$log_id}
userdata2={$file_type}
userdata3={$scanned}
userdata4={$malware_detected}
userdata5={$filter}
userdata6={$threat_cloud_malware}
userdata7={$error_count}
userdata8={$family}
userdata9={$product}

[0022 - 4800 update_check]
event_type=event
precheck="update_status"
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{1,2}:\d\d:\d\d)\s(?P<device>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+\S+\s+\S+\s+\S+\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+>\s*log_id:(?P<log_id>[^;]*);update_status:(?P<update_status>\d+)(?:[^;]*;)*?scanned_files:(?P<scanned_files>\d+);(?:[^;]*;)*?malware_detected:(?P<malware_detected>\d+);(?:[^;]*;)*?scanned_files_on_threat_cloud:(?P<scanned_on_cloud>\d+)(?:[^;]*;)*?malware_detected_on_threat_cloud:(?P<malware_on_cloud>\d+);(?:[^;]*;)*?average_emulated_file_size:(?P<av_emulated_file_size>\d+);"
date={normalize_date($date)}
plugin_sid=15
device={resolv($device)}
src_ip={resolv($device)}
dst_ip={resolv($dst_ip)}
userdata1={$log_id}
userdata2={$scanned_files}
userdata3={$malware_detected}
userdata4={$scanned_on_cloud}
userdata5={$malware_on_cloud}
userdata6={$av_emulated_file_size}

[0023 - config changed ]
event_type=event
precheck="message"
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{1,2}:\d\d:\d\d)\s(?P<device>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+\S+\s+\S+\s+\S+\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+>\s+message:(?P<msg>[^;]*);user:(?P<username>[^;]*);old IP:(?P<old_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3});old\sport:(?P<old_port>[^;]*);new\sIP:(?P<new_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3});new\s+port:(?P<new_port>[^;]*);session_uid:(?P<session_uid>[^;]*);fw_subproduct:(?P<fw_subproduct>[^;]*);vpn_feature_name:(?P<vpn>[^;]*);product:(?P<product>[^;]*);product_family:(?P<product_family>[^;]*)"
date={normalize_date($date)}
plugin_sid=19
device={resolv($device)}
username={$username}
src_ip={resolv($device)}
dst_ip={resolv($dst_ip)}
userdata1={$old_ip}
userdata2={$new_ip}
userdata3={$old_port}
userdata4={$new_port}
userdata5={$msg}
userdata6={$session_uid}
userdata7={$fw_subproduct}
userdata8={$vpn}
userdata9={$product}

[0030 - fw4800]
event_type=event
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d{1,2}:\d\d:\d\d)\s(?P<device>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}).*?(?:;proxy_src_ip:(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))?;(?:user:(?P<username>[^;]*);)?.*?snid:(?P<snid>[^;]*);product:(?P<product>[^;]*);service:(?P<service>[^;]*);s_port:(?P<src_port>\d+);product_family:(?P<product_family>\S+)"
date={normalize_date($date)}
plugin_sid={translate($product)}
device={$device}
src_ip={$src_ip}
src_port={$src_port}
username={$username}
userdata1={$snid}
userdata2={$service}
userdata3={$product_family}

[0099 - generic rule - ##GENERIC-RULE##]
event_type=event
regexp="^(?:\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s([^\s]+)\s+\S+\s+(?P<date>\d{1,2}\w{3}\d{4}\s+\d{1,2}:\d\d:\d\d)(?:.*?src:\s(?P<src_ip>[^\;]+);)?(?:.*?dst:\s(?P<dst_ip>[^;]+);)?"
plugin_sid=20000000
date={normalize_date($date)}
device={resolv($1)}
src_ip={resolv($src_ip)}
dst_ip={resolv($dst_ip)}
