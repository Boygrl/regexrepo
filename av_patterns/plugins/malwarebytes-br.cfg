# Alienvault plugin
# Author: Alienvault Team at avteam@alienvault.com
# Plugin malwarebytes-br id:1773 version: 0.0.2
# Last modification: 2016-09-21 12:25
#
# Plugin Selection Info:
# Malwarebytes:Breach Remediation:-
#
# END-HEADER
# Accepted products:
#

[DEFAULT]
plugin_id=1773


[config]
type=detector
enable=yes

source=log
location=/var/log/malwarebytes-br.log

create_file=false

process=
start=no
stop=no
startup=
shutdown=

[translation]
_DEFAULT_=20000000

[malware_class]
1 = Any other event except a detection/restore
5 = Restore event of a selected file
9 = Detection/removal of PUP/PUM from a scan
10 = Detection/removal of Virus from a scan


[0001 - Malwarebytes Breach Remediation - CEF event]
event_type=event
regexp="(?P<date>\w+\s+\d+\s+\d+:\d+:\d+)\s+(?P<device>\S+)\sCEF:\s*(?P<version>[^|]*)\|(?P<vendor>[^|]*)\|(?P<product>[^|]*)\|(?P<device_version>[^|]*)\|(?P<signature_id>[^|]*)\|(?P<name>[^|]*)\|(?P<severity>[^|]*)\|cs3=(?P<session_id>\S*)\s*cs3Label=\S*\scs5=(?P<cmd_line>.+?)cs5Label=\S*\sdvchost=(?P<hostname>\S*)\sdeviceMacAddress=(?P<src_mac>\S*)\s*suser=(?P<username>\S*)\soutcome=(?P<result>\S*)\s(?:(?:rt=|start=|end=)(?P<date_time>\w+\s+\d+\s+\d+\s\d+:\d+:\d+)?\s*|cs1Label=\S*\s*|cs2Label=\S*\s*|cs4Label=\S*\s*|cs1=(?P<malware_name>\S*)\s*|cs2=(?P<malware_hash>\S*)\s|cs4=(?P<agentSeverity>\S*)\s*|filePath=(?P<path>.*?\.\w*)\s|act=(?P<action>\S*)\s*|cat=(?P<malware_category>\S*)\s*|cs6=(?P<error_msg>.*?)cs6Label=\S*\s|cn1=(?P<error_number>\S*)\s*|cn1Label=\S*\s|msg=(?P<msg>.*))+"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={$signature_id}
src_ip={resolv($device)}
username={$username}
filename={$path}
userdata1={$severity}
userdata2={$hostname}
userdata3={$src_mac}
userdata4={$result}
userdata5={$malware_name}
userdata6={$malware_hash}
userdata7={translate2($agentSeverity,$malware_class)}
userdata8={$action}
userdata9={$error_msg}
