# Alienvault plugin
# Author: Alienvault Team at devel@alienvault.com
# Plugin watchguard id:1691 version: 0.0.13
# Last modification: 2016-10-09 14:30
#
# Plugin Selection Info:
# WatchGuard:XTM Series:-
#
# END-HEADER
# Accepted products:
# watchguard - XTM 11.6.1
# watchguard - XTM 11.9.56:11
# watchguard - XTM OS 1.2
# Description:
#
# Watchguard XTM v11.6.1 Plugin
# Thanks to: @agoller and @ash.wilson
#
# Syslog Configuration.
# In order to configure this plugin to read the logs in the correct place,
# please add the bellow configuration to your rsyslog configuration folder:
# file: /etc/rsyslog.d/zzzzz_watchguard.conf
# -- begin file
# if $fromhost-ip == 'YOUR_DEVICE_IP' then /var/log/watchguard.log
# if $fromhost == 'YOUR_DEVICE_HOSTNAME' then /var/log/watchguard.log
# & ~
# -- end file
#
#
#


[DEFAULT]
plugin_id=1691

[config]
type=detector
enable=yes

source=log
location=/var/log/watchguard.log

create_file=false

process=
start=no
stop=no
startup=
shutdown=

[translation]

3000-0152=1000
3000-0153=1001
3000-0154=1002
3000-0155=1003
3000-0156=1004
3000-0157=1005
3000-0158=1006
3000-0159=1007
3000-0160=1008
3000-0161=1009
3000-0162=1010
3000-0163=1011
3000-0164=1012
3000-0165=1013
3000-0166=1014
3000-0167=1015
3000-0168=1016
3000-0169=1017
3000-0170=1018
3000-0171=1019
3000-002A=1020
3000-003A=1021
3000-003C=1022
3000-012D=1023
3000-012E=1024
3000-0006=1025
3000-0007=1026
3000-0027=1027
3000-0028=1028
3000-0029=1029
3000-0040=1030
3000-00C9=1031
3000-00CB=1032
3000-002F=1033
3000-012C=1034
3000-0004=1035
3000-0005=1036
3000-0148=1037
3000-0149=1038
3000-0150=1039
3000-0151=1040
3001-1001=1041
5A00-000A=1042
5A00-000B=1043
5A00-000C=1044
5A00-000D=1045
5A00-0001=1046
5A00-0002=1047
5A00-0003=1048
5A00-0004=1049
5A00-0005=1050
5A00-0006=1051
5A00-0007=1052
5A00-0008=1053
5A00-0009=1054
3100-000F=1055
3100-003D=1056
3100-004F=1057
3100-005A=1058
3100-005B=1059
3100-005C=1060
3100-005D=1061
3100-005E=1062
9000-001=1063
9000-0001=1063
9000-002=1064
9000-0002=1064
9000-006=1065
9000-0006=1065
9000-007=1066
9000-0007=1066
3100-0003=1067
3100-0004=1068
3100-0030=1069
3100-0031=1070
3100-0034=1071
3100-0035=1072
3100-0036=1073
3100-0037=1074
3100-0038=1075
3100-0050=1076
3100-0051=1077
3100-0057=1078
3100-0058=1079
3100-0059=1080
3100-0070=1081
3113-0001=1082
4500-0001=1083
5600-0001=1084
5601-0002=1085
5601-0003=1086
5601-0004=1087
5602-0001=1088
5602-0002=1089
5602-0003=1090
5602-0004=1091
5602-0005=1092
5602-0006=1093
5603-0001=1094
5604-0001=1095
5604-0002=1096
0900-000A=1097
3100-000A=1098
3100-000B=1099
3100-000D=1100
3100-002A=1101
3100-002B=1102
3100-002C=1103
3100-003A=1104
3100-003B=1105
3100-003E=1106
3100-003F=1107
3100-006A=1108
3100-006C=1109
3100-006D=1110
6100-000A=1111
6100-000B=1112
6100-000C=1113
6100-000E=1114
6100-000F=1115
9000-004=1116
9000-0004=1116
9000-005=1117
9000-0005=1117
9000-008=1118
9000-0008=1118
9000-009=1119
9000-0009=1119
1600-0001=1120
1600-0002=1121
1600-0003=1122
3100-0009=1123
3100-0010=1124
3100-0029=1125
3100-0039=1126
3100-0046=1127
3100-0047=1128
3100-0052=1129
3100-0054=1130
3100-0055=1131
3100-0056=1132
3100-0069=1133
3100-0071=1134
3100-0072=1135
4500-0003=1136
4500-0004=1137
4900-0001=1138
4900-0002=1139
4900-0003=1140
5600-0002=1141
5600-0003=1142
5601-0001=1143
5601-0005=1144
6100-0002=1145
6100-0003=1146
6100-0004=1147
6100-0005=1148
6100-0006=1149
6100-0007=1150
6100-0008=1151
6100-0009=1152
0F00-0015=1153
1B04-00CE=1154
1C02-00CD=1155
1AFF-000A=1156
1AFF-000B=1157
1AFF-000C=1158
1AFF-000D=1159
1AFF-000E=1160
1AFF-000F=1161
1AFF-0001=1162
1AFF-001A=1163
1AFF-001B=1164
1AFF-001C=1165
1AFF-001D=1166
1AFF-001E=1167
1AFF-001F=1168
1AFF-0002=1169
1AFF-002B=1170
1AFF-002C=1171
1AFF-002D=1172
1AFF-002E=1173
1AFF-002F=1174
1AFF-0003=1175
1AFF-0004=1176
1AFF-0005=1177
1AFF-0006=1178
1AFF-0007=1179
1AFF-0008=1180
1AFF-0009=1181
1AFF-0010=1182
1AFF-0011=1183
1AFF-0012=1184
1AFF-0013=1185
1AFF-0016=1186
1AFF-0018=1187
1AFF-0019=1188
1AFF-0020=1189
1AFF-0021=1190
1AFF-0022=1191
1AFF-0023=1192
1AFF-0024=1193
1AFF-0025=1194
1AFF-0026=1195
1AFF-0028=1196
1AFF-0029=1197
1AFF-0030=1198
1AFF-0031=1199
1AFF-0032=1200
1AFF-0033=1201
1AFF-0034=1202
1AFF-0036=1203
1BFF-0000=1204
1BFF-000A=1205
1BFF-000C=1206
1BFF-000E=1207
1BFF-000F=1208
1BFF-0001=1209
1BFF-001A=1210
1BFF-001B=1211
1BFF-001C=1212
1BFF-001D=1213
1BFF-001E=1214
1BFF-001F=1215
1BFF-0002=1216
1BFF-002A=1217
1BFF-0003=1218
1BFF-0004=1219
1BFF-0005=1220
1BFF-0006=1221
1BFF-0007=1222
1BFF-0010=1223
1BFF-0011=1224
1BFF-0013=1225
1BFF-0014=1226
1BFF-0015=1227
1BFF-0016=1228
1BFF-0017=1229
1BFF-0018=1230
1BFF-0019=1231
1BFF-0021=1232
1BFF-0022=1233
1BFF-0023=1234
1BFF-0024=1235
1BFF-0025=1236
1BFF-0026=1237
1BFF-0027=1238
1BFF-0028=1239
1CFF-0000=1240
1CFF-000C=1241
1CFF-000D=1242
1CFF-000E=1243
1CFF-000F=1244
1CFF-0001=1245
1CFF-0002=1246
1CFF-0003=1247
1CFF-0004=1248
1CFF-0005=1249
1CFF-0006=1250
1CFF-0007=1251
1CFF-0008=1252
1CFF-0009=1253
1CFF-0010=1254
1CFF-0011=1255
1CFF-0012=1256
1CFF-0013=1257
1CFF-0014=1258
1CFF-0015=1259
1CFF-0017=1260
1DFF-0000=1261
1DFF-000A=1262
1DFF-000C=1263
1DFF-000E=1264
1DFF-000F=1265
1DFF-0001=1266
1DFF-0002=1267
1DFF-0003=1268
1DFF-0004=1269
1DFF-0005=1270
1DFF-0006=1271
1DFF-0007=1272
1DFF-0008=1273
1DFF-0009=1274
1DFF-0010=1275
1DFF-0012=1276
2AFF-0000=1277
2AFF-0001=1278
2AFF-0002=1279
2AFF-0003=1280
2AFF-0006=1281
2AFF-0007=1282
2CFF-0000=1283
2CFF-0001=1284
2CFF-0002=1285
2CFF-0003=1286
2CFF-0007=1287
2CFF-0008=1288
2CFF-0009=1289
2DFF-0000=1290
2DFF-0001=1291
2DFF-0004=1292
2DFF-0005=1293
21FF-0000=1294
21FF-000A=1295
21FF-000C=1296
21FF-000F=1297
21FF-0001=1298
21FF-001A=1299
21FF-001B=1300
21FF-001C=1301
21FF-001D=1302
21FF-001E=1303
21FF-0002=1304
21FF-0005=1305
21FF-0006=1306
21FF-0007=1307
21FF-0009=1308
21FF-0010=1309
21FF-0012=1310
21FF-0014=1311
21FF-0015=1312
21FF-0016=1313
21FF-0017=1314
21FF-0018=1315
28FF-0000=1316
28FF-0004=1317
28FF-0005=1318
28FF-0006=1319
28FF-0008=1320
28FF-0009=1321
5501-000C=1322
5501-000D=1323
5501-001C=1324
5501-0010=1325
5501-0014=1326
5501-0015=1327
5501-0017=1328
5501-0018=1329
3D04-0001=1330
3D04-0002=1331
3E00-0002=1332
3E00-0003=1333
3E00-0004=1334
133F-0065=1335
1010-001=1336
1010-0001=1336
1010-002=1337
1010-0002=1337
1020-001=1338
1020-0001=1338
1020-002=1339
1020-0002=1339
1020-003=1340
1020-0003=1340
1020-005=1341
1020-0005=1341
1040-001=1342
1040-0001=1342
1100-000C=1343
1100-000D=1344
1100-000E=1345
1100-000F=1346
5501-000B=1347
5501-001A=1348
5501-001D=1349
1100-0003=1350
1100-0004=1351
1100-0005=1352
1500-0000=1353
1500-0001=1354
1501-0000=1355
1501-0001=1356
4001-0001=1357
4100-0001=1358
4100-0002=1359
4100-0003=1360
4100-0004=1361
4100-0005=1362
4100-0006=1363
4100-0007=1364
4100-0008=1365
4101-0001=1366
4101-0002=1367
5501-0000=1368
5501-0002=1369
5501-0003=1370
5501-0004=1371
5501-0005=1372
5501-0006=1373
5501-0007=1374
5501-0008=1375
5501-0013=1376
5501-0016=1377
5501-0019=1378
5501-0020=1379
5501-0021=1380
5501-0022=1381
5800-0001=1382
3A00-000A=1383
3A00-000B=1384
3A00-000C=1385
3A00-0002=1386
3A00-0004=1387
3A00-0005=1388
3A00-0006=1389
3A00-0007=1390
3A00-0008=1391
3B00-0001=1392
3B00-0002=1393
3800-025C=1394
3800-0002=1395
3800-0003=1396
3800-0004=1397
3800-0264=1398
3A00-000E=1399
3A00-000F=1400
3800-025A=1401
3800-025B=1402
3800-027A=1403
3800-027E=1404
3900-000C=1405
3900-000D=1406
3900-000E=1407
3900-000F=1408
3800-0278=1409
3800-0279=1410
3800-0280=1411
3800-0282=1412
3900-0003=1413
3900-0005=1414
3900-0007=1415
3900-0010=1416
3900-0011=1417
3900-0012=1418
3900-0015=1419
3900-0016=1420
3900-0019=1421
3900-0058=1422
1F00-0001=1423
1F01-0015=1424
2E00-0005=1425
2E00-0006=1426
2E01-001A=1427
2E01-001B=1428
2E01-0017=1429
2E01-0018=1430
2E01-0019=1431
2E02-0065=1432
2E02-0066=1433
2E02-0067=1434
2E02-0069=1435
2300-0001=1436
2300-0002=1437
020B-0001=1438
0203-000A=1439
0203-000B=1440
0203-000C=1441
0203-000D=1442
0203-000E=1443
0203-000F=1444
0205-000A=1445
0205-000B=1446
0205-000C=1447
0205-000D=1448
0205-000E=1449
0205-000F=1450
2000-001=1451
2000-0001=1451
2000-002=1452
2000-0002=1452
2020-001=1453
2020-0001=1453
2030-002=1454
2030-0002=1454
2030-003=1455
2030-0003=1455
2030-004=1456
2030-0004=1456
2030-005=1457
2030-0005=1457
2030-006=1458
2030-0006=1458
2030-007=1459
2030-0007=1459
2030-008=1460
2030-0008=1460
2030-009=1461
2030-0009=1461
2030-010=1462
2030-0010=1462
2030-011=1463
2030-0011=1463
2030-012=1464
2030-0012=1464
2030-014=1465
2030-0014=1465
2030-015=1466
2030-0015=1466
2030-016=1467
2030-0016=1467
2030-017=1468
2030-0017=1468
2030-018=1469
2030-0018=1469
2030-019=1470
2030-0019=1470
2030-020=1471
2030-0020=1471
2030-021=1472
2030-0021=1472
2030-022=1473
2030-0022=1473
2030-023=1474
2030-0023=1474
2030-024=1475
2030-0024=1475
2030-026=1476
2030-0026=1476
2030-027=1477
2030-0027=1477
2050-002=1478
2050-0002=1478
2050-003=1479
2050-0003=1479
2050-004=1480
2050-0004=1480
2050-005=1481
2050-0005=1481
2050-006=1482
2050-0006=1482
2050-007=1483
2050-0007=1483
2050-008=1484
2050-0008=1484
2050-010=1485
2050-0010=1485
2050-011=1486
2050-0011=1486
2060-001=1487
2060-0001=1487
2060-002=1488
2060-0002=1488
2060-003=1489
2060-0003=1489
2060-004=1490
2060-0004=1490
2060-005=1491
2060-0005=1491
2060-006=1492
2060-0006=1492
2060-007=1493
2060-0007=1493
2080-001=1494
2080-0001=1494
1400-0000=1495
1400-0002=1496
2500-0000=1497
2500-0001=1498
5B01-0001=1499
5B01-0002=1500
5B01-0003=1501
2010-001=1502
2010-0001=1502
2010-002=1503
2010-0002=1503
2010-003=1504
2010-0003=1504
2010-004=1505
2010-0004=1505
2070-001=1506
2070-0001=1506
2090-001=1507
2090-0001=1507
2090-002=1508
2090-0002=1508
Allow=1509
Deny=1510
0101-0001=1516
3D00-0001=1517
0201-0001=1518
0201-0002=1519
0201-0003=1520
dvcpcd=10
sslvpn=30
http-proxy=40
Received=52
Sending=53
Phase=54
Connection closed=56
Closing server=57
address resolution=58
#oss-daemon messages
connections.c.313=60
request.c.1110=61
request.c.1122=62
connections.c.285=63
mod_fastcgi.c.1733=64
mod_fastcgi.c.2999=65
mod_fastcgi.c.2826=66
http-header-glue.c.176=67
#generic messages
sshd=70
sigd=71
oss-daemon=72
webblocker=73
pxy=74
iked=50
#event logs
rejected=100
accepted=101
logged in=102
logged off=103
logged out=103

#
0203-0006=1523
0203-0007=1524
0203-0012=1525
0203-0015=1526
0F00-0016=1527
1600-0065=1528
1600-0066=1529
1AFF-0039=1530
#

#   RULES
[0001 - Watchguard - new format]
event_type=event
precheck="msg_id="
regexp="(?P<date_event>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s*(?P<device>\S*)\s*(?:(?!msg_id)\S+\s+)*msg_id="(?P<msg_id>[^"]*)"\s*(?P<action>\w+) (?P<srcname>\S+(?:\sPrimary|\sDMZ|\sSecondary|\sBackup)?) (?P<dstname>\S+(?:\sPrimary|\sDMZ|\sSecondary|\sBackup)?) (?:\d+\s+)?(?P<protocol>\S+)\s+.*?(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<srcport>\d+)\s+(?P<dstport>\d+)\s*(?:offset\s\d\s\w+\s\d+\s\w*\s\d+\s*)?(?:msg="(?P<msg>.*?(?P<sid_subinfo>APT|IPS)?[^("A)]*)"\s*|app_name="(?P<app_name>[^"]*)"\s*|signature_name="(?P<signature_name>[^"]*)"\s*|proxy_act="(?P<proxy_act>[^"]*)"\s*|cat_name="[^"]*"\s*|virus="[^"]*"\s*|host="(?P<host>[^"]*)"\s*|app_beh_name="[^"]*"\s*|app_id="(?P<app_id>[^"]*)"\s*|cats="(?P<cats>[^"]*)"\s*|path="(?P<path>[^"]*)"\s*|op="(?P<op>[^"]*)"\s*|signature_id="(?P<signature_id>[^"]*)"\s*|signature_cat="(?P<signature_cat>[^"]*)"\s*|severity="(?P<severity>[^"]*)"\s*|dstname="(?P<dsthostname>[^"]*)"\s*|app_cat_id="(?P<app_cat_id>[^"]*)"\s*|arg="(?P<arg>[^"]*)"\s*|app_ctl_disp="(?P<app_ctl_disp>[^"]*)"\s*|md5="(?P<md5>[^"]*)"\s*|task_uuid="(?P<task_uuid>[^"]*)"\s*|threat_level="(?P<threat_level>[^"]*)"\s*|sent_bytes="(?P<sent_bytes>\d+"\s*)|rcvd_bytes="(?P<rcvd_bytes>\d+)"\s*|elapsed_time="(?P<elapsed_time>[^"]*)"\s*|id=\d+\s*|seq=\d+\s*|[^(]\S+\s*)*(?:\((?P<policy>[^)]*)\)|$)"
date={normalize_date($date_event)}
device={resolv($device)}
plugin_sid={translate($msg_id)}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$signature_name}
userdata4={$severity}
userdata5={$op}
userdata6={$sid_subinfo}
userdata7={$threat_level}
userdata8={$action}
userdata9={$policy}

[0002 - Watchguard - with Source/Destination IP]
event_type=event
precheck="Source IP"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s\S+\s\([^)]+\)\s(?P<process_name>[^:]*):\s*msg_id="(?P<msg_id>[^"]*)"\s(?P<msg>.*?)\sDetails='Policy\sName:\s(?P<policy_name>\S+)\sReason:\s(?P<reason>\S+)\sMessage:\s(?P<message>.*?(?P<apt_ips>APT|IPS).*?)Task_UUID:\s(?P<uuid>\S+)\sMD5:\s(?P<md5>\S+)\sSource\sIP:\s(?P<src_ip>\S+)\sSource\sPort:\s(?P<src_port>\S+)\sDestination\sIP:\s(?P<dst_ip>\S+)\sDestination\sPort:\s(?P<dst_port>\S+)\sProxy\sType:\s(?P<proxy_type>.*?)Host:\s(?P<host>\S+)\sPath:\s(?P<path>\S+)"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($msg_id)}
src_ip={$src_ip}
src_port={resolv($src_port)}
dst_ip={resolv($dst_ip)}
dst_port={$dst_port}
filename={$path}
userdata1={$policy_name}
userdata2={$reason}
userdata3={$proxy_type}
userdata4={$uuid}
userdata5={$md5}
userdata6={$apt_ips}
userdata7={$host}
userdata8={$message}
userdata9={$msg}

[0003 - Proxy Message with Rule]
event_type=event
precheck="rule_name"
regexp="(?:\S+\s+\S+\s+(?P<log_level>Local\d+\.\S+)\s+(?P<src_host>\S+)\s+)?(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+.*?(?P<process_name>http-proxy).*?:\s+(?P<action>\w+) (?P<srcname>\S+) (?P<dstname>\S+) (?:\d+\s+)?(?P<protocol>\S+)\s+(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<srcport>\d+)\s+(?P<dstport>\d+)\s+msg="(?P<msg>[^"]*)"\s+proxy_act="(?P<proxy_act>[^"]*)"\s+rule_name="(?P<rule_name>[^"]*)"\s+header="(?P<header>[^"]*)"\s+src_user=\S+"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($action)}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$msg}
userdata4={$process_name}
userdata5={$proxy_act}
userdata6={$action}
userdata7={$rule_name}
userdata8={$header}
userdata9={$log_level}

[0004 - Proxy Message]
event_type=event
precheck="http-proxy"
regexp="(?:\S+\s+\S+\s+(?P<log_level>Local\d+\.\S+)\s+(?P<src_host>\S+)\s+)?(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+.*?(?P<process_name>http-proxy).*?:\s+(?P<action>\w+) (?P<srcname>\S+) (?P<dstname>\S+) (?:\d+\s+)?(?P<protocol>\S+)\s+(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<srcport>\d+)\s+(?P<dstport>\d+)\s+msg="(?P<msg>[^"]*)"\s+proxy_act="(?P<proxy_act>[^"]*)"\s+op="(?P<http_op>[^"]*)"\s+dstname="(?P<dst_name>[^"]*)"\s+arg="(?P<arg>[^"]*)"\s+.*?reputation="(?P<reputation>[^"]*)"\s+(?P<policy>.*)"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($action)}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$msg}
userdata4={$process_name}
userdata5={$proxy_act}
userdata6={$http_op}
userdata7={$dst_name}
userdata8={$reputation}
userdata9={$policy}

[0005 - IPS Message]
event_type=event
precheck="IPS"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+(?P<log_level>local\d+\.\S+).*?(?P<process_name>http-proxy).*?:\s+(?P<action>\w+) (?P<srcname>\S+) (?P<dstname>\S+) (?:\d+\s+)?(?P<protocol>\S+)\s+(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<srcport>\d+)\s+(?P<dstport>\d+)\s+msg="(?P<msg>.*?(?P<sid_subinfo>IPS)[^"]*)"\s+proxy_act="(?P<proxy_act>[^"]*)".*?severity="(?P<severity>[^"]*)"\s+signature_name="(?P<signature_name>[^"]*)"\s+signature_cat="(?P<signature_cat>[^"]*)"\s+host="(?P<host>[^"]*)"\s+path="(?P<path>[^"]*)"\s+(?P<policy>.*)"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($action)}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$msg}
userdata4={$severity}
userdata5={$signature_name}
userdata6={$sid_subinfo}
userdata7={$signature_cat}
userdata8={$path}
userdata9={$policy}

[0006 - Application Control]
event_type=event
precheck="app_name"
regexp="\S+\s+\S+\s+(?P<log_level>Local\d+\.\S+)\s+(?P<src_host>\S+)\s+(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+(?P<process_name>[^\[:]*).*?:\s+(?P<action>\w+) (?P<srcname>\S+) (?P<dstname>\S+) (?:\d+\s+){0,}(?P<protocol>\S+)\s+(?:\d+\s+){0,}(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<srcport>\d+)\s+(?P<dstport>\d+)\s+.*?app_name="(?P<app_name>[^"]*)"\s+app_cat_name="(?P<app_cat_name>[^"]*)"\s+(?:\S+\s+){3}app_beh_name="(?P<app_beh_name>[^"]*)".*?msg="(?P<msg>[^"]*)"\s+(?P<policy>.*)"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($action)}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$msg}
userdata4={$process_name}
userdata5={$app_name}
userdata6={$app_cat_name}
userdata7={$app_beh_name}
userdata8={$log_level}
userdata9={$policy}

[0007 - DLP Message]
event_type=event
precheck="dlp_sensor"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+(?P<log_level>local\d+\.\S+).*?(?P<process_name>ftp-proxy).*?:\s+(?P<action>\w+) (?P<srcname>\S+) (?P<dstname>\S+) (?:\d+\s+)?(?P<protocol>\S+)\s+(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<srcport>\d+)\s+(?P<dstport>\d+)\s+msg="(?P<msg>[^"]*)"\s+proxy_act="(?P<proxy_act>[^"]*)"\s+dlp_sensor="(?P<dlp_sensor>[^"]*)"\s+dlp_rule="(?P<dlp_rule>[^"]*)"\s+authenticated_user="(?P<authenticated_user>[^"]*)"\s+file="(?P<file>[^"]*)"\s+(?P<policy>.*)"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($action)}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
username={$authenticated_user}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$msg}
userdata4={$log_level}
userdata5={$proxy_act}
userdata6={$dlp_sensor}
userdata7={$dlp_rule}
userdata8={$file}
userdata9={$policy}

[0008 - Webblocker Message]
event_type=event
precheck="http-proxy"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+(?P<log_level>local\d+\.\S+).*?(?P<process_name>http-proxy).*?:\s+(?P<action>\w+) (?P<srcname>\S+) (?P<dstname>\S+) (?:\d+\s+)?(?P<protocol>\S+)\s+(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<srcport>\d+)\s+(?P<dstport>\d+)\s+msg="(?P<msg>[^"]*)"\s+proxy_act="(?P<proxy_act>[^"]*)"\s+cats="(?P<category>[^"]*)"\s+op="(?P<http_op>[^"]*)"\s+dstname="(?P<dst_name>[^"]*)"\s+arg="(?P<arg>[^"]*)"\s+(?P<policy>.*)"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($action)}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$msg}
userdata4={$category}
userdata5={$proxy_act}
userdata6={$http_op}
userdata7={$dst_name}
userdata8={$arg}
userdata9={$policy}

[0009 - Antivirus Message]
event_type=event
precheck="virus="
regexp="(?:\S+\s+\S+\s+(?P<log_level>Local\d\.\S+)\s+(?P<src_host>\S+)\s+)?(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+.*?(?P<process_name>http-proxy).*?:\s+(?P<action>\w+) (?P<srcname>\S+) (?P<dstname>\S+) (?:\d+\s+)?(?P<protocol>\S+)\s+(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<srcport>\d+)\s+(?P<dstport>\d+)\s+msg="(?P<msg>[^"]*)"\s+proxy_act="(?P<proxy_act>[^"]*)"\s+virus="(?P<virus>[^"]*)"\s+src_user="(?P<src_user>[^"]*)"\s+(?P<policy>.*)"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($action)}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
username={$src_user}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$msg}
userdata4={$virus}
userdata5={$proxy_act}
userdata9={$policy}

[0010 - Traffic Message]
event_type=event
precheck="http-proxy"
regexp="\S+\s+\S+\s+(?P<log_level>Local\d+\.\S+)\s+(?P<src_host>\S+)\s+(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+(?P<process_name>[^\[]*).*?:\s+(?P<action>\w+) (?P<srcname>\S+) (?P<dstname>\S+) (?:\d+\s+)?(?P<protocol>\S+)\s+(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<srcport>\d+)\s+(?P<dstport>\d+)\s+msg="(?P<msg>[^"]*)"\s+(?P<policy>.*)"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($action)}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$msg}
userdata4={$process_name}
userdata9={$policy}


# Authentication of SSLVPN user [<user>] from <ip> rejected - ...
# Authentication of SSLVPN user [<user>] from <ip> accepted
# SSL VPN user <user> from <ip> rejected - all other error.
[0020 - Event Log - Authentication failure/success]
event_type=event
precheck="user"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+(?:(?P<server>\S+)\s*\((?P<might_appear_date>\w{4}-\d\d-\d\dT\d\d:\d\d:\d\d)\)\s*)?(?P<process_name>[^\[:]*)[^:]*:\s+(?:msg_id="(?P<msg_id>[^"]*)"\s+)?(?P<msg>.*?user\s+\[?(?P<user>.*?)\]?\s+from\s+(?P<srcip>\S+)\s+(?P<action>rejected|accepted).*)"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($action)}
src_ip={$srcip}
dst_ip={resolv($device)}
username={$user}
userdata1={$msg_id}
userdata2={$server}

# SSL VPN user <user> from <src_ip> logged in assigned virtual IP is <nat>
[0021 - Event Log - VPN SSL log in/out]
event_type=event
precheck="VPN SSL"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+(?P<server>\S+)\s*\((?P<date2>\w{4}-\d\d-\d\dT\d\d:\d\d:\d\d\))\s*(?P<process_name>[^\[:]*)[^:]*:\s+(?:msg_id="(?P<msg_id>[^"]*)"\s+)?SSL VPN\s*user\s*(?P<user>\S+)\s*from\s*(?P<src_ip>\S+)\s*(?P<sid>logged in|logged out)\s*assigned virtual IP is (?P<src_nat>\S+)"
date={normalize_date($date2)}
device={resolv($device)}
plugin_sid={translate($sid)}
src_ip={$src_ip}
dst_ip={resolv($device)}
username={$user}
userdata1={$msg_id}
userdata2={$src_nat}
userdata3={$server}
userdata4={$process_name}

# Mobile VPN with SSL user logged in. Virtual IP address is <nat>. Real IP address is <src_ip>.
[0022 - Event Log - Mobile VPN logged in]
event_type=event
precheck="Mobile VPN"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+(?P<server>\S+)\s*\((?P<date2>\w{4}-\d\d-\d\dT\d\d:\d\d:\d\d\))\s*(?P<process_name>[^\[:]*)[^:]*:\s+(?:msg_id="(?P<msg_id>[^"]*)"\s+)?Mobile VPN with SSL\s*user\s*(?P<sid>logged in)\.\s*Virtual IP address is (?P<src_nat>\S+)\.\s*Real IP address is\s*(?P<src_ip>\S+)"
date={normalize_date($date2)}
device={resolv($device)}
plugin_sid={translate($sid)}
src_ip={$src_ip}
dst_ip={resolv($device)}
userdata1={$msg_id}
userdata2={$src_nat}
userdata3={$server}
userdata4={$process_name}

# Mobile VPN with SSL user logged off. Virtual IP address is <src_ip>
[0023 - Event Log - Mobile VPN logged off]
event_type=event
precheck="Mobile VPN"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+(?P<server>\S+)\s*\((?P<date2>\w{4}-\d\d-\d\dT\d\d:\d\d:\d\d\))\s*(?P<process_name>[^\[:]*)[^:]*:\s+(?:msg_id="(?P<msg_id>[^"]*)"\s+)?Mobile VPN with SSL\s*user\s*(?P<sid>logged off)\.\s*Virtual IP address is (?P<src_ip>\S+)\.\s*"
date={normalize_date($date2)}
device={resolv($device)}
plugin_sid={translate($sid)}
src_ip={$src_ip}
dst_ip={resolv($device)}
userdata1={$msg_id}
userdata2={$process_name}
userdata3={$server}

[0101 - traffic]
event_type=event
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+)\s+.*?:\s+(?:msg_id="(?P<msg_id>[^"]*)"\s+)?(?P<action>\w+) (?P<srcname>\S+) (?P<dstname>\S+) (?:\d+\s+)?(?P<protocol>\S+).*?(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}) (?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}) (?P<srcport>\d+) (?P<dstport>\d+)\s+(?:msg="(?P<msg>[^"]*)")?(?:\s+proxy_act="(?P<proxy_act>[^"]*)")?.*?(?:src_user="(?P<username>[^"]*)")"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid={translate($action)}
username={$username}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$msg_id}
userdata4={$msg}
userdata5={$proxy_act}

[0102 - traffic no user]
event_type=event
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+)\s+.*?:\s+(?:msg_id="(?P<msg_id>[^"]*)"\s+)?(?P<action>\w+) (?P<srcname>\S+(?:\sPrimary|\sSecondary|\sBackup)?) (?P<dstname>\S+(?:\sPrimary|\sSecondary|\sBackup)?) (?:\d+\s+)?(?P<protocol>\S+).*?(?P<srcip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}) (?P<dstip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?: (?P<srcport>\d+) (?P<dstport>\d+)\s+)?(?:msg="(?P<msg>[^"]*)")?(?:\s+proxy_act="(?P<proxy_act>[^"]*)")?"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid={translate($msg_id)}
src_ip={$srcip}
src_port={$srcport}
dst_ip={$dstip}
dst_port={$dstport}
protocol={$protocol}
userdata1={$srcname}
userdata2={$dstname}
userdata3={$msg_id}
userdata4={$msg}
userdata5={$proxy_act}
userdata8={$action}

[0103 - IKE packet received with msg_id]
event_type=event
precheck="msg_id="
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+)\s+\S+\s+\S+\s+(?P<action>\S+)\[\d+\]:\s+msg_id="(?P<msg_id>[^"]+)"\s+\((?P<local_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})<\->(?P<remote_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\).*?(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?:\:|\/)(?P<src_port>\d+).*?(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?:\:|\/)(?P<dst_port>\d+)\s(?P<status>[^.]+).\sGateway-Endpoint='(?P<gw_endpoint>[^']+)'\sReason=(?P<reason>.*)"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid={translate($msg_id)}
src_ip={resolv($src_ip)}
dst_ip={resolv($dst_ip)}
src_port={$src_port}
dst_port={$dst_port}
userdata1={$action}
userdata2={$status}
userdata3={$gw_endpoint}
userdata4={$reason}


[0104 - IKE packet received]
event_type=event
precheck="ike"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+)\s+\S+\s+\S+\s+(?P<action>\S+)\[\d+\]:\s+(?:\S+\s+)?\((?P<local_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\<\-\>(?P<remote_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\).*?(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?:\:|\/)(?P<src_port>\d+)(?:\(socket=(?P<socket>\d+)\s+ifIndex=(?P<ifindex>\d+)\)\s+from)?.*?(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?:\:|\/)(?P<dst_port>\d+)"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid=51
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
userdata1={$action}
userdata2={$socket}
userdata3={$ifindex}

[0105 - Connection failed chB]
event_type=event
precheck="failed"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+)\s+\S+\s+\S+\s+(?P<action>\S+)\[\d+\]\:.*?(?P<src1_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\:(?P<src1_port>\d+)\s+->\s+(?P<dst1_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\:(?P<dst1_port>\d+).*?(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\:(?P<src_port>\d+)\s+->\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\:(?P<dst_port>\d+).*?\[\~?\!(?P<failed_channel>\S)"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid=55
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
userdata1={$action}
userdata2={$failed_channel}
userdata3={$src1_ip}
userdata4={$src1_port}
userdata5={$dst1_ip}
userdata6={$dst1_port}

[0106 - Connection failed chA]
event_type=event
precheck="failed"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+)\s+\S+\s+\S+\s+(?P<action>\S+)\[\d+\]\:.*?(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\:(?P<src_port>\d+)\s+\-\>\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\:(?P<dst_port>\d+).*?\[\~?\!(?P<failed_channel>\S)"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid=55
src_ip={$src_ip}
dst_ip={$dst_ip}
src_port={$src_port}
dst_port={$dst_port}
userdata1={$action}
userdata2={$failed_channel}

[0107 - IKE message received-deleted]
event_type=event
precheck="message"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+)\s+\S+\s+\S+\s+(?P<action>\S+)\[\d+\]:\s+\((?P<local_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\<\-\>(?P<remote_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\)(?P<sid>Sending|Received|Phase).*?(?:from|to)\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\:(?P<dst_port>\d+)(?:\s+for\s+(?P<hostname>\S+).*?Seq=(?P<seq>\d+)\s+DataSz=(?P<datasz>\d+))?"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid={translate($sid)}
src_ip={$local_ip}
dst_ip={$dst_ip}
dst_port={$dst_port}
userdata1={$action}
userdata2={$hostname}
userdata3={$seq}
userdata4={$datasz}

[0108 - IKE traffic]
event_type=event
precheck="ike"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+).*?(?P<action>\S+)\[\d+\]:\s+\((?P<local_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\<\-\>(?P<remote_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\)(?P<process>[^:]*)\:?\s+(?P<message>.*)"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid=50
src_ip={$local_ip}
dst_ip={$remote_ip}
userdata1={$action}
userdata2={$process}
userdata3={$message}

[0109 - connection closed]
event_type=event
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+)\s+\S+\s+\S+\s+(?P<action>\S+)\[\d+\]\:.*?(?P<sid>Connection closed|Closing server|address resolution).*?(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?P<msg>.*)"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid={translate($sid)}
src_ip={$src_ip}
userdata1={$action}
userdata3={$msg}


[0110 - Event Log]
event_type=event
precheck="msg_id"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<device>\S+)\s+(?:\S+\s+){0,2}(?P<process_name>[^\[:]*)[^:]*:\s+msg_id="(?P<msg_id>[^"]*)"\s+(?P<msg>(?:.*?(?P<src_ip>\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}))?.*)"
date={normalize_date($date)}
device={resolv($device)}
plugin_sid={translate($msg_id)}
src_ip={resolv($src_ip)}
userdata1={$msg_id}
userdata2={$msg}

[0111 - sigd-up-to-date]
event_type=event
regexp="^(?P<date>\SYSLOG_DATE)\s+(?P<sensor>\S+).*?(?P<action>sigd)\[\d+\]: msg_id=\"(?P<msg_id>[^\"]+)\" (?P<msg>.*)"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid={translate($msg_id)}
userdata1={$msg}
userdata2={$action}

[0112 - oss-daemon events]
event_type=event
precheck="oss-daemon"
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+).*?(?P<action>\S+)\[\d+\]\:.*?\((?P<sid>[^\(|\)]*)\)\s+(?P<msg>.*)"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid={translate($sid)}
userdata1={$msg}

[0113 - Generic message]
event_type=event
regexp="(?P<date>\w{1,4}\s+\d{1,2}\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<sensor>\S+)\s+\S+\s+\S+\s+(?P<action>\S+)\[\d+\]\:(?P<message>.*)"
date={normalize_date($date)}
device={resolv($sensor)}
plugin_sid=999999
userdata1={$message}
userdata2={$action}

[0999-generic]
event_type=event
regexp="^(?P<date>\SYSLOG_DATE)\s+(?P<sensor>\S+).*?: (?P<log>.*)"
date={normalize_date($date)}
device={$sensor}
plugin_sid=999999
userdata1={$log}



[1001 - Firewall configd]
#example logs
#Jan 26 03:59:36 XTMv-testing (2016-01-26T08: 59:36) configd[1442]: msg_id="0101-0001" Management user admin@Firebox-DB from 10.0.1.5 modified System
#Jan 26 04:00:19 XTMv-test-fw (2016-01-26T09: 00:19) configd[1442]: msg_id="0101-0001" Management user admin@Firebox-DB from 10.0.1.5 modified Policy  Outgoing-00
event_type=event
precheck="configd"
regexp=^(?P<date>\S+\s+\d+\s+\d\d:\d\d:\d\d)\s+(?P<hostname>\S+)\s+\((?P<date2>\d{4}-\d{2}-\d{2}T\d{2}:\s+\d{2}:\d{2})\)\s+configd\[\d+\]:\s+msg_id=\"(?P<plugin_sid>.*?)\"\s+(?P<group>\w+)\s+user\s+(?P<username>\S+)\s+from\s+(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<userdata1>\w+)\s+(?P<userdata2>\w+)\s+(?P<userdata3>\S+)
date={normalize_date($date)}
plugin_sid={translate($plugin_sid)}
username={$username}
userdata1={$userdata1}
userdata2={$userdata2}
userdata3={$userdata3}
userdata4={$group}

[1002 - Traffic message with Rule]
#example logs
#Jan 26 03:59:59 XTMv-test-fw (2016-01-26T08: 59:59) firewall: msg_id="3000-0148" Deny 1-Trusted Firebox 52 tcp 20 128 10.0.1.5 10.0.1.1 54184 8080 offset 8 S 2687711238 win 32 msg="ddos client quota"  (Internal Policy)
#Jan 26 04:00:02 XTMv-test-fw (2016-01-26T09: 00:02) firewall: msg_id="3000-0148" Allow 1-Trusted 0-External 52 tcp 20 127 10.0.1.5 208.69.168.99 54212 4112 offset 8 S 1317139840 win 32  (Outgoing-00)
event_type=event
precheck="offset"
regexp=^(?P<date>\S+\s+\d+\s+\d\d:\d\d:\d\d)\s+(?P<hostname>.*?)\s+\((?P<date2>\d{4}-\d{2}-\d{2}T\d{2}:\s+\d{2}:\d{2})\)\s+firewall:\s+msg_id=\"(?P<plugin_sid>.*?)\"\s+(?P<action>Deny|Allow)\s+(?P<rule_src>\S+)\s+(?P<rule_dst>\S+)\s+(?P<packet_length>\d+)\s+(?P<proto>\w+)\s+(?P<ttl>\d+)\s+(?P<num3>\d+)\s+(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<src_port>\d+)\s+(?P<dst_port>\d+)\s+offset\s+(?P<num1>\d+)\s+(?P<val1>\w+)\s+(?P<packet_size>\d+)\s+(?P<info>.*?)\s+\((?P<policy_name>.*?)\)
date={normalize_date($date)}
device={resolv($hostname)}
plugin_sid={translate($action)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$proto}
userdata1={$rule_src}
userdata2={$rule_dst}
userdata3={$action}
userdata4={$policy_name}
userdata5={$packet_size}
userdata6={$info}
userdata7={$ttl}
userdata8={$plugin_sid}

[1003 - Traffic message no rule]
#example logs
#Jan 26 03:59:59 XTMv-test-fw (2016-01-26T08: 59:59) firewall: msg_id="3000-0148" Deny 1-Trusted Firebox 52 tcp 20 128 10.0.1.5 10.0.1.1 54184 8080 offset 8 S 2687711238 win 32 msg="ddos client quota"  (Internal Policy)
#Jan 26 04:00:02 XTMv-test-fw (2016-01-26T09: 00:02) firewall: msg_id="3000-0148" Allow 1-Trusted 0-External 52 tcp 20 127 10.0.1.5 208.69.168.99 54212 4112 offset 8 S 1317139840 win 32  (Outgoing-00)
event_type=event
precheck="msg_id"
regexp=^(?P<date>\S+\s+\d+\s+\d\d:\d\d:\d\d)\s+(?P<hostname>.*?)\s+\((?P<date2>\d{4}-\d{2}-\d{2}T\d{2}:\s+\d{2}:\d{2})\)\s+firewall:\s+msg_id=\"(?P<plugin_sid>.*?)\"\s+(?P<action>Deny|Allow)\s+(?P<rule_src>\S+)\s+(?P<rule_dst>\S+)\s+(?P<packet_length>\d+)\s+(?P<proto>\w+)\s+(?P<ttl>\d+)\s+(?P<num3>\d+)\s+(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<dst_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+(?P<src_port>\d+)\s+(?P<dst_port>\d+)\s+\((?P<policy_name>.*?)\)
date={normalize_date($date)}
device={resolv($hostname)}
plugin_sid={translate($plugin_sid)}
src_ip={$src_ip}
src_port={$src_port}
dst_ip={$dst_ip}
dst_port={$dst_port}
protocol={$proto}
userdata1={$rule_src}
userdata2={$rule_dst}
userdata3={$action}
userdata4={$policy_name}

[1004 - Traffic message with Rule OLD SAMPLE]
#example logs
#2016-01-04 16:08:58 Deny 169.254.8.21 169.254.255.255 netbios-ns/udp 137 137 1-Trusted Firebox ip spoofing sites 78 128 (Internal Policy) proc_id="firewall" rc="101" msg_id="3000-0148"
#2016-01-04 16:09:46 Deny 10.0.1.5 10.0.1.1 ftp/tcp 49700 21 1-Trusted Firebox Denied 52 128 (Unhandled Internal Packet-00) proc_id="firewall" rc="101" msg_id="3000-0148" tcp_info="offset 8 S 2670668139 win 32"
event_type=event
precheck="msg_id"
regexp='^(?P<date>\d+-\d+-\d+\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<action>Deny|Allow)\s+(?P<src_ip>\S+)\s+(?P<dst_ip>\S+)\s+(?P<port_name>.*?)\/(?P<proto>\w+)\s+(?P<src_port_num>\d+)\s+(?P<dst_port_num>\d+)\s+(?P<rule_note>.*?)\s+Firebox\s+(?P<action2>\w+(\s+\w+)*?)\s+(?P<userdata1>\d+)\s+(?P<userdata2>\d+)\s+\((?P<userdata3>.*?)\)\s+proc_id=\"(?P<proc_id>\w+)\"\s+rc=\"(?P<rc>\d+)\"\s+msg_id=\"(?P<plugin_sid>.*?)\"'
date={normalize_date($date)}
plugin_sid={translate($plugin_sid)}
src_ip={$src_ip}
src_port={$src_port_num}
dst_ip={$dst_ip}
dst_port={$dst_port_num}
protocol={$proto}
userdata1={$userdata1}
userdata2={$userdata2}
userdata3={$userdata3}
userdata4={$action}
userdata5={$action2}
userdata6={$proc_id}
userdata7={$rc}}
userdata8={$rule_note}
userdata9={$port_name}

[1005 - DVCPD]
#example logs
#Jan 26 04:02:53 XTMv-test-fw (2016-01-26T09: 02:53) dvcpcd[1547]: I/O error on SSL connection
#Jan 26 04:02:53 XTMv-test-fw (2016-01-26T09: 02:53) dvcpcd[1547]: **Error: Unable to connect to server 0.0.0.0 - ssl connection handshake failure
event_type=event
precheck="dvcpcd"
regexp=^(?P<date>\S+\s+\d+\s+\d\d:\d\d:\d\d)\s+(?P<hostname>\S+)\s+\((?P<date2>\d{4}-\d{2}-\d{2}T\d{2}:\s+\d{2}:\d{2})\)\s+dvcpcd\[\d+\]:\s+\*\*Error:\s+(?P<userdata1>.*?)\s+(?P<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+-\s+(?P<userdata2>.*)
date={normalize_date($date)}
src_ip={$src_ip}
plugin_sid=10
userdata1={$userdata1}
userdata2={$userdata2}

[1006 - Firewall messages with rule id]
#example logs
#Jan 26 04:00:19 XTMv-test-fw (2016-01-26T09: 00:19) firewall[1497]: msg_id="3000-0004" The Application Control feature has expired.
#Jan 26 04:00:19 XTMv-test-fw (2016-01-26T09: 00:19) firewall[1497]: msg_id="3000-0005" The IPS feature has expired.
event_type=event
precheck="msg_id"
regexp=^(?P<date>\S+\s+\d+\s+\d\d:\d\d:\d\d)\s+(?P<hostname>\S+)\s+\((?P<date2>\d{4}-\d{2}-\d{2}T\d{2}:\s+\d{2}:\d{2})\)\s+firewall\[\d+\]:\s+msg_id=\"(?P<plugin_sid>.*?)\"\s+(?P<msg>.*)
date={normalize_date($date)}
plugin_sid={translate($plugin_sid)}
userdata1={$msg}

[1007 - Firewall messages other]
#example logs
#Jan 26 04:00:19 XTMv-test-fw (2016-01-26T09: 00:19) firewall[1497]: etGetLinkStatus: <<Error>> ETHTOOL_GLINK for interface eth2 failed: No such device (19)
event_type=event
precheck="firewall"
regexp=^(?P<date>\S+\s+\d+\s+\d\d:\d\d:\d\d)\s+(?P<hostname>\S+)\s+\((?P<date2>\d{4}-\d{2}-\d{2}T\d{2}:\s+\d{2}:\d{2})\)\s+firewall\[\d+\]:\s+(?P<userdata1>.*?)\<\<(?P<userdata2>.*?)\>\>\s+(?P<userdata3>.*)
date={normalize_date($date)}
plugin_sid=1511
userdata1={$userdata1}
userdata2={$userdata2}
userdata3={$userdata3}

[1008 - Stats non Security]
#example logs
#2016-01-04 16:58:03 wan 5626 75540 unix_time="1451944683.479164"
#2016-01-04 16:58:03 tunnel 0 0 unix_time="1451944683.982091"
event_type=event
precheck="unix_time"
regexp='(?P<date>\d+-\d+-\d+\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<item>\w+)\s+(?P<value1>\d+)\s+(?P<value2>\d+)\s+unix_time=\"(?P<unix_time>.*?)\"'
date={normalize_date($date)}
plugin_sid=1512
userdata1={$value1}
userdata2={$value2}}
userdata3={$unix_time}

[1009 - Stats only Security]
#example logs
#2016-01-04 16:17:04 security unix_time="1451944605.912109" dlp_allow="0" dlp_drop="0" dlp_quarantined="0" dlp_scanned="0" gav_drop="0" gav_notscanned="0" gav_scanned="0" ips_scanned="0" ips_detected="0" ips_prevented="0" red_bad="0" red_good="0" red_inconclusive="0" spam_scanned="0" spam_drop="0" spam_tagged="0" spam_quarantined="0" apt_scanned="0" apt_prevented="0" apt_notified="0" apt_quarantined="0"
event_type=event
#precheck="rule_name"
regexp='(?P<date>\d+-\d+-\d+\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<item>\w+)\s+unix_time=\"(?P<unix_time>.*?)\"\s+dlp_allow=\"(?P<dlp_allow>\d+)\"\s+dlp_drop=\"(?P<dlp_drop>\d+)\"\s+dlp_quarantined=\"(?P<dlp_quarantined>\d+)\"\s+dlp_scanned=\"(?P<dlp_scanned>\d+)\"\s+gav_drop=\"(?P<gav_drop>\d+)\"\s+gav_notscanned=\"(?P<gav_notscanned>\d+)\"\s+gav_scanned=\"(?P<gav_scanned>\d+)\"\s+ips_scanned=\"(?P<ips_scanned>\d+)\"\s+ips_detected=\"(?P<ips_dectected>\d+)\"\s+ips_prevented=\"(?P<ips_prevented>\d+)\"\s+red_bad=\"(?P<red_bad>\d+)\"\s+red_good=\"(?P<red_good>\d+)\"\s+red_inconclusive=\"(?P<red_inc>\d+)\"\s+spam_scanned=\"(?P<spam_scanned>\d+)\"\s+spam_drop=\"(?P<spam_drop>\d+)\"\s+spam_tagged=\"(?P<spam_tagged>\d+)\"\s+spam_quarantined=\"(?P<spam_quar>\d+)\"\s+apt_scanned=\"(?P<apt_scanned>\d+)\"\s+apt_prevented=\"(?P<apt_prevented>\d+)\"\s+apt_notified=\"(?P<apt_notified>\d+)\"\s+apt_quarantined=\"(?P<apt_quarantined>\d+)\"'
date={normalize_date($date)}
plugin_sid=1513
userdata1={$ips_dectected}
userdata2={$ips_prevented}
userdata3={$ips_scanned}
userdata4={$apt_scanned}
userdata5={$apt_prevented}
userdata6={$apt_notified}
userdata7={$spam_drop}
userdata8={$spam_quar}
userdata9={$spam_tagged}

[1010 - Event Logs with ID]
#example logs
#2016-01-04 16:07:04 firewall The IPS feature has expired. id="3000-0005"
#2016-01-04 16:07:04 drclient Invalid or missing feature key for dynamic routing protocol OSPF id="5601-0001"
event_type=event
precheck=" id="
regexp='(?P<date>\d+-\d+-\d+\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<item>\w+)\s+(?P<userdata1>.*?)\s+id=\"(?P<plugin_sid>.*?)\"'
date={normalize_date($date)}
plugin_sid={translate($plugin_sid)}
userdata1={$userdata1}
userdata2={$item}

[1020 - Diagnostics only Kernel]
#example logs
#2016-01-04 16:07:04 kernel [ 0.197839] NMI watchdog: disabled (cpu0): hardware events not enabled
#2016-01-04 16:07:04 kernel [ 0.337396] ACPI: Enabled 2 GPEs in block 00 to 0F
event_type=event
precheck="kernel"
regexp=^(?P<date>\d+-\d+-\d+\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<item>\w+)\s+\[(?P<value>[^\]]*)\]\s+(?P<msg>.*)
date={normalize_date($date)}
plugin_sid=1515
userdata1={$item}
userdata2={$value}
userdata3={$msg}

[1021 - Diagnostics non Kernel]
#example logs
#2016-01-04 16:07:04 firewall lic_enf_read: license features PRO should be valid value
#2016-01-04 16:07:04 admd wgadmAuthPortalUpdate(): CFGAPI_BIND failed
event_type=event
regexp=^(?P<date>\d+-\d+-\d+\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<item>\w+.*?)\s+(?P<msg>.*)
date={normalize_date($date)}
plugin_sid=1514
userdata1={$item}
userdata2={$msg}

[1098 - Generic via message sample 2]
#example logs
#
event_type=event
#precheck="rule_name"
regexp=^(?P<date>\S+\s+\d+\s+\d\d:\d\d:\d\d)\s+(?P<hostname>\S+)\s+\((?P<date2>\d{4}-\d{2}-\d{2}T\d{2}:\s+\d{2}:\d{2})\)\s+(?P<userdata2>.*)
date={normalize_date($date)}
plugin_sid=999999
userdata2={$userdata2}

[1099 - Generic via message sample 1]
#example logs
#
event_type=event
regexp=^(?P<date>\d+-\d+-\d+\s+\d{1,2}:\d{1,2}:\d{1,2})\s+(?P<msg>.*)
date={normalize_date($date)}
plugin_sid=999999
userdata1={$msg}
